"use strict";(globalThis.webpackChunkproton_pass_extension=globalThis.webpackChunkproton_pass_extension||[]).push([[7568],{55184:(t,e,r)=>{r.d(e,{AES256:()=>l});
/**
 * @file {@link http://asmjs.org Asm.js} implementation of the {@link https://en.wikipedia.org/wiki/Advanced_Encryption_Standard Advanced Encryption Standard}.
 * @author Artem S Vybornov <vybornov@gmail.com>
 * @license MIT
 */
var n=function(){var t,e,r=!1;function n(r,n){var i=t[(e[r]+e[n])%255];return 0!==r&&0!==n||(i=0),i}var i,s,a,o,h=!1;function c(){function c(r){var n,i,s;for(i=s=function(r){var n=t[255-e[r]];return 0===r&&(n=0),n}(r),n=0;n<4;n++)s^=i=255&(i<<1|i>>>7);return s^=99}r||function(){t=[],e=[];var n,i,s=1;for(n=0;n<255;n++)t[n]=s,i=128&s,s<<=1,s&=255,128===i&&(s^=27),s^=t[n],e[t[n]]=n;t[255]=t[0],e[0]=0,r=!0}(),i=[],s=[],a=[[],[],[],[]],o=[[],[],[],[]];for(var u=0;u<256;u++){var f=c(u);i[u]=f,s[f]=u,a[0][u]=n(2,f)<<24|f<<16|f<<8|n(3,f),o[0][f]=n(14,u)<<24|n(9,u)<<16|n(13,u)<<8|n(11,u);for(var p=1;p<4;p++)a[p][u]=a[p-1][u]>>>8|a[p-1][u]<<24,o[p][f]=o[p-1][f]>>>8|o[p-1][f]<<24}h=!0}var u=function(t,e){h||c();var r=new Uint32Array(e);r.set(i,512),r.set(s,768);for(var n=0;n<4;n++)r.set(a[n],4096+1024*n>>2),r.set(o[n],8192+1024*n>>2);var u=function(t,e,r){"use asm";var n=0,i=0,s=0,a=0,o=0,h=0,c=0,u=0,f=0,p=0,l=0,y=0,d=0,_=0,v=0,g=0,A=0,w=0,m=0,E=0,x=0;var b=new t.Uint32Array(r),U=new t.Uint8Array(r);function C(t,e,r,o,h,c,u,f){t=t|0;e=e|0;r=r|0;o=o|0;h=h|0;c=c|0;u=u|0;f=f|0;var p=0,l=0,y=0,d=0,_=0,v=0,g=0,A=0;p=r|0x400,l=r|0x800,y=r|0xc00;h=h^b[(t|0)>>2],c=c^b[(t|4)>>2],u=u^b[(t|8)>>2],f=f^b[(t|12)>>2];for(A=16;(A|0)<=o<<4;A=A+16|0){d=b[(r|h>>22&1020)>>2]^b[(p|c>>14&1020)>>2]^b[(l|u>>6&1020)>>2]^b[(y|f<<2&1020)>>2]^b[(t|A|0)>>2],_=b[(r|c>>22&1020)>>2]^b[(p|u>>14&1020)>>2]^b[(l|f>>6&1020)>>2]^b[(y|h<<2&1020)>>2]^b[(t|A|4)>>2],v=b[(r|u>>22&1020)>>2]^b[(p|f>>14&1020)>>2]^b[(l|h>>6&1020)>>2]^b[(y|c<<2&1020)>>2]^b[(t|A|8)>>2],g=b[(r|f>>22&1020)>>2]^b[(p|h>>14&1020)>>2]^b[(l|c>>6&1020)>>2]^b[(y|u<<2&1020)>>2]^b[(t|A|12)>>2];h=d,c=_,u=v,f=g}n=b[(e|h>>22&1020)>>2]<<24^b[(e|c>>14&1020)>>2]<<16^b[(e|u>>6&1020)>>2]<<8^b[(e|f<<2&1020)>>2]^b[(t|A|0)>>2],i=b[(e|c>>22&1020)>>2]<<24^b[(e|u>>14&1020)>>2]<<16^b[(e|f>>6&1020)>>2]<<8^b[(e|h<<2&1020)>>2]^b[(t|A|4)>>2],s=b[(e|u>>22&1020)>>2]<<24^b[(e|f>>14&1020)>>2]<<16^b[(e|h>>6&1020)>>2]<<8^b[(e|c<<2&1020)>>2]^b[(t|A|8)>>2],a=b[(e|f>>22&1020)>>2]<<24^b[(e|h>>14&1020)>>2]<<16^b[(e|c>>6&1020)>>2]<<8^b[(e|u<<2&1020)>>2]^b[(t|A|12)>>2]}function D(t,e,r,n){t=t|0;e=e|0;r=r|0;n=n|0;C(0x0000,0x0800,0x1000,x,t,e,r,n)}function k(t,e,r,n){t=t|0;e=e|0;r=r|0;n=n|0;var s=0;C(0x0400,0x0c00,0x2000,x,t,n,r,e);s=i,i=a,a=s}function T(t,e,r,f){t=t|0;e=e|0;r=r|0;f=f|0;C(0x0000,0x0800,0x1000,x,o^t,h^e,c^r,u^f);o=n,h=i,c=s,u=a}function B(t,e,r,f){t=t|0;e=e|0;r=r|0;f=f|0;var p=0;C(0x0400,0x0c00,0x2000,x,t,f,r,e);p=i,i=a,a=p;n=n^o,i=i^h,s=s^c,a=a^u;o=t,h=e,c=r,u=f}function S(t,e,r,f){t=t|0;e=e|0;r=r|0;f=f|0;C(0x0000,0x0800,0x1000,x,o,h,c,u);o=n=n^t,h=i=i^e,c=s=s^r,u=a=a^f}function O(t,e,r,f){t=t|0;e=e|0;r=r|0;f=f|0;C(0x0000,0x0800,0x1000,x,o,h,c,u);n=n^t,i=i^e,s=s^r,a=a^f;o=t,h=e,c=r,u=f}function P(t,e,r,f){t=t|0;e=e|0;r=r|0;f=f|0;C(0x0000,0x0800,0x1000,x,o,h,c,u);o=n,h=i,c=s,u=a;n=n^t,i=i^e,s=s^r,a=a^f}function q(t,e,r,o){t=t|0;e=e|0;r=r|0;o=o|0;C(0x0000,0x0800,0x1000,x,f,p,l,y);y=~g&y|g&y+1;l=~v&l|v&l+((y|0)==0);p=~_&p|_&p+((l|0)==0);f=~d&f|d&f+((p|0)==0);n=n^t;i=i^e;s=s^r;a=a^o}function z(t,e,r,n){t=t|0;e=e|0;r=r|0;n=n|0;var i=0,s=0,a=0,f=0,p=0,l=0,y=0,d=0,_=0,v=0;t=t^o,e=e^h,r=r^c,n=n^u;i=A|0,s=w|0,a=m|0,f=E|0;for(;(_|0)<128;_=_+1|0){if(i>>>31){p=p^t,l=l^e,y=y^r,d=d^n}i=i<<1|s>>>31,s=s<<1|a>>>31,a=a<<1|f>>>31,f=f<<1;v=n&1;n=n>>>1|r<<31,r=r>>>1|e<<31,e=e>>>1|t<<31,t=t>>>1;if(v)t=t^0xe1000000}o=p,h=l,c=y,u=d}function H(t){t=t|0;x=t}function F(t,e,r,o){t=t|0;e=e|0;r=r|0;o=o|0;n=t,i=e,s=r,a=o}function L(t,e,r,n){t=t|0;e=e|0;r=r|0;n=n|0;o=t,h=e,c=r,u=n}function N(t,e,r,n){t=t|0;e=e|0;r=r|0;n=n|0;f=t,p=e,l=r,y=n}function j(t,e,r,n){t=t|0;e=e|0;r=r|0;n=n|0;d=t,_=e,v=r,g=n}function M(t,e,r,n){t=t|0;e=e|0;r=r|0;n=n|0;y=~g&y|g&n,l=~v&l|v&r,p=~_&p|_&e,f=~d&f|d&t}function R(t){t=t|0;if(t&15)return-1;U[t|0]=n>>>24,U[t|1]=n>>>16&255,U[t|2]=n>>>8&255,U[t|3]=n&255,U[t|4]=i>>>24,U[t|5]=i>>>16&255,U[t|6]=i>>>8&255,U[t|7]=i&255,U[t|8]=s>>>24,U[t|9]=s>>>16&255,U[t|10]=s>>>8&255,U[t|11]=s&255,U[t|12]=a>>>24,U[t|13]=a>>>16&255,U[t|14]=a>>>8&255,U[t|15]=a&255;return 16}function V(t){t=t|0;if(t&15)return-1;U[t|0]=o>>>24,U[t|1]=o>>>16&255,U[t|2]=o>>>8&255,U[t|3]=o&255,U[t|4]=h>>>24,U[t|5]=h>>>16&255,U[t|6]=h>>>8&255,U[t|7]=h&255,U[t|8]=c>>>24,U[t|9]=c>>>16&255,U[t|10]=c>>>8&255,U[t|11]=c&255,U[t|12]=u>>>24,U[t|13]=u>>>16&255,U[t|14]=u>>>8&255,U[t|15]=u&255;return 16}function G(){D(0,0,0,0);A=n,w=i,m=s,E=a}function I(t,e,r){t=t|0;e=e|0;r=r|0;var o=0;if(e&15)return-1;while((r|0)>=16){K[t&7](U[e|0]<<24|U[e|1]<<16|U[e|2]<<8|U[e|3],U[e|4]<<24|U[e|5]<<16|U[e|6]<<8|U[e|7],U[e|8]<<24|U[e|9]<<16|U[e|10]<<8|U[e|11],U[e|12]<<24|U[e|13]<<16|U[e|14]<<8|U[e|15]);U[e|0]=n>>>24,U[e|1]=n>>>16&255,U[e|2]=n>>>8&255,U[e|3]=n&255,U[e|4]=i>>>24,U[e|5]=i>>>16&255,U[e|6]=i>>>8&255,U[e|7]=i&255,U[e|8]=s>>>24,U[e|9]=s>>>16&255,U[e|10]=s>>>8&255,U[e|11]=s&255,U[e|12]=a>>>24,U[e|13]=a>>>16&255,U[e|14]=a>>>8&255,U[e|15]=a&255;o=o+16|0,e=e+16|0,r=r-16|0}return o|0}function J(t,e,r){t=t|0;e=e|0;r=r|0;var n=0;if(e&15)return-1;while((r|0)>=16){Q[t&1](U[e|0]<<24|U[e|1]<<16|U[e|2]<<8|U[e|3],U[e|4]<<24|U[e|5]<<16|U[e|6]<<8|U[e|7],U[e|8]<<24|U[e|9]<<16|U[e|10]<<8|U[e|11],U[e|12]<<24|U[e|13]<<16|U[e|14]<<8|U[e|15]);n=n+16|0,e=e+16|0,r=r-16|0}return n|0}var K=[D,k,T,B,S,O,P,q];var Q=[T,z];return{set_rounds:H,set_state:F,set_iv:L,set_nonce:N,set_mask:j,set_counter:M,get_state:R,get_iv:V,gcm_init:G,cipher:I,mac:J}}({Uint8Array,Uint32Array},t,e);return u.set_key=function(t,e,n,s,a,h,c,f,p){var l=r.subarray(0,60),y=r.subarray(256,316);l.set([e,n,s,a,h,c,f,p]);for(var d=t,_=1;d<4*t+28;d++){var v=l[d-1];(d%t==0||8===t&&d%t==4)&&(v=i[v>>>24]<<24^i[v>>>16&255]<<16^i[v>>>8&255]<<8^i[255&v]),d%t==0&&(v=v<<8^v>>>24^_<<24,_=_<<1^(128&_?27:0)),l[d]=l[d-t]^v}for(var g=0;g<d;g+=4)for(var A=0;A<4;A++){v=l[d-(4+g)+(4-A)%4];y[g+A]=g<4||g>=d-4?v:o[0][i[v>>>24]]^o[1][i[v>>>16&255]]^o[2][i[v>>>8&255]]^o[3][i[255&v]]}u.set_rounds(t+5)},u};return u.ENC={ECB:0,CBC:2,CFB:4,OFB:6,CTR:7},u.DEC={ECB:1,CBC:3,CFB:5,OFB:6,CTR:7},u.MAC={CBC:0,GCM:1},u.HEAP_DATA=16384,u}();function i(t){return t instanceof Uint8Array}function s(t,e,r,n,i){const s=t.length-e,a=s<i?s:i;return t.set(r.subarray(n,n+a),e),a}function a(...t){const e=t.reduce(((t,e)=>t+e.length),0),r=new Uint8Array(e);let n=0;for(let e=0;e<t.length;e++)r.set(t[e],n),n+=t[e].length;return r}Error;class o extends Error{constructor(...t){super(...t),Object.create(Error.prototype,{name:{value:"IllegalArgumentError"}})}}class h extends Error{constructor(...t){super(...t),Object.create(Error.prototype,{name:{value:"SecurityError"}})}}const c=[],u=[];class f{constructor(t,e,r=!0,n,i,s){this.pos=0,this.len=0,this.mode=n,this.pos=0,this.len=0,this.key=t,this.iv=e,this.padding=r,this.acquire_asm(i,s)}acquire_asm(t,e){return void 0!==this.heap&&void 0!==this.asm||(this.heap=t||c.pop()||function(t,e){const r=t?t.byteLength:e||65536;if(4095&r||r<=0)throw new Error("heap size must be a positive integer and a multiple of 4096");return t||new Uint8Array(new ArrayBuffer(r))}().subarray(n.HEAP_DATA),this.asm=e||u.pop()||new n(null,this.heap.buffer),this.reset(this.key,this.iv)),{heap:this.heap,asm:this.asm}}release_asm(){void 0!==this.heap&&void 0!==this.asm&&(c.push(this.heap),u.push(this.asm)),this.heap=void 0,this.asm=void 0}reset(t,e){const{asm:r}=this.acquire_asm(),n=t.length;if(16!==n&&24!==n&&32!==n)throw new o("illegal key size");const i=new DataView(t.buffer,t.byteOffset,t.byteLength);if(r.set_key(n>>2,i.getUint32(0),i.getUint32(4),i.getUint32(8),i.getUint32(12),n>16?i.getUint32(16):0,n>16?i.getUint32(20):0,n>24?i.getUint32(24):0,n>24?i.getUint32(28):0),void 0!==e){if(16!==e.length)throw new o("illegal iv size");let t=new DataView(e.buffer,e.byteOffset,e.byteLength);r.set_iv(t.getUint32(0),t.getUint32(4),t.getUint32(8),t.getUint32(12))}else r.set_iv(0,0,0,0)}AES_Encrypt_process(t){if(!i(t))throw new TypeError("data isn't of expected type");let{heap:e,asm:r}=this.acquire_asm(),a=n.ENC[this.mode],o=n.HEAP_DATA,h=this.pos,c=this.len,u=0,f=t.length||0,p=0,l=0,y=new Uint8Array(c+f&-16);for(;f>0;)l=s(e,h+c,t,u,f),c+=l,u+=l,f-=l,l=r.cipher(a,o+h,c),l&&y.set(e.subarray(h,h+l),p),p+=l,l<c?(h+=l,c-=l):(h=0,c=0);return this.pos=h,this.len=c,y}AES_Encrypt_finish(){let{heap:t,asm:e}=this.acquire_asm(),r=n.ENC[this.mode],i=n.HEAP_DATA,s=this.pos,a=this.len,h=16-a%16,c=a;if(this.hasOwnProperty("padding")){if(this.padding){for(let e=0;e<h;++e)t[s+a+e]=h;a+=h,c=a}else if(a%16)throw new o("data length must be a multiple of the block size")}else a+=h;const u=new Uint8Array(c);return a&&e.cipher(r,i+s,a),c&&u.set(t.subarray(s,s+c)),this.pos=0,this.len=0,this.release_asm(),u}AES_Decrypt_process(t){if(!i(t))throw new TypeError("data isn't of expected type");let{heap:e,asm:r}=this.acquire_asm(),a=n.DEC[this.mode],o=n.HEAP_DATA,h=this.pos,c=this.len,u=0,f=t.length||0,p=0,l=c+f&-16,y=0,d=0;this.padding&&(y=c+f-l||16,l-=y);const _=new Uint8Array(l);for(;f>0;)d=s(e,h+c,t,u,f),c+=d,u+=d,f-=d,d=r.cipher(a,o+h,c-(f?0:y)),d&&_.set(e.subarray(h,h+d),p),p+=d,d<c?(h+=d,c-=d):(h=0,c=0);return this.pos=h,this.len=c,_}AES_Decrypt_finish(){let{heap:t,asm:e}=this.acquire_asm(),r=n.DEC[this.mode],i=n.HEAP_DATA,s=this.pos,a=this.len,c=a;if(a>0){if(a%16){if(this.hasOwnProperty("padding"))throw new o("data length must be a multiple of the block size");a+=16-a%16}if(e.cipher(r,i+s,a),this.hasOwnProperty("padding")&&this.padding){let e=t[s+c-1];if(e<1||e>16||e>c)throw new h("bad padding");let r=0;for(let n=e;n>1;n--)r|=e^t[s+c-n];if(r)throw new h("bad padding");c-=e}}const u=new Uint8Array(c);return c>0&&u.set(t.subarray(s,s+c)),this.pos=0,this.len=0,this.release_asm(),u}}class p{static encrypt(t,e,r){return new p(e,r).encrypt(t)}static decrypt(t,e,r){return new p(e,r).decrypt(t)}constructor(t,e,r){this.aes=r||new f(t,e,!0,"CFB"),delete this.aes.padding}encrypt(t){return a(this.aes.AES_Encrypt_process(t),this.aes.AES_Encrypt_finish())}decrypt(t){return a(this.aes.AES_Decrypt_process(t),this.aes.AES_Decrypt_finish())}}const l={blockSize:16,decrypt:(t,e,r)=>p.decrypt(t,e,r)}}}]);
//# sourceMappingURL=chunk.7568.js.map