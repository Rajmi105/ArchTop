"use strict";(globalThis.webpackChunkproton_pass_extension=globalThis.webpackChunkproton_pass_extension||[]).push([[4584,2772,1016,8036],{31016:(t,e,i)=>{i.d(e,{default:()=>s});var r=i(28036),n=i(77680);
/*! OpenPGP.js v6.0.0-alpha.0 - 2023-12-12 - this is LGPL licensed code, see LICENSE/our website https://openpgpjs.org/ for more information. */
"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;class s extends n.B{constructor(t){if(super(),void 0===t)throw Error("Invalid BigInteger input");const e=("string"==typeof t||t instanceof String)&&t.startsWith("0x");this.value=e?new r.B(t.substring(2),16):new r.B(t)}clone(){return new s(this.value.clone())}iinc(){return this.value.iadd(new r.B(1)),this}inc(){return this.clone().iinc()}idec(){return this.value.isub(new r.B(1)),this}dec(){return this.clone().idec()}iadd(t){return this.value.iadd(t.value),this}add(t){return this.clone().iadd(t)}isub(t){return this.value.isub(t.value),this}sub(t){return this.clone().isub(t)}imul(t){return this.value.imul(t.value),this}mul(t){return this.clone().imul(t)}imod(t){return this.value=this.value.umod(t.value),this}mod(t){return this.clone().imod(t)}modExp(t,e){const i=e.isEven()?r.B.red(e.value):r.B.mont(e.value),n=this.clone();return n.value=n.value.toRed(i).redPow(t.value).fromRed(),n}modInv(t){if(!this.gcd(t).isOne())throw Error("Inverse does not exist");return new s(this.value.invm(t.value))}idiv(t){return this.value=this.value.div(t.value),this}div(t){return this.clone().idiv(t)}gcd(t){return new s(this.value.gcd(t.value))}ileftShift(t){return t.isNegative()?this.irightShift(t.negate()):(this.value.ishln(t.value.toNumber()),this)}leftShift(t){return this.clone().ileftShift(t)}irightShift(t){return t.isNegative()?this.ileftShift(t.negate()):(this.value.ishrn(t.value.toNumber()),this)}rightShift(t){return this.clone().irightShift(t)}ixor(t){return this.value.ixor(t.value),this}xor(t){return this.clone().ixor(t)}ibitwiseAnd(t){return this.value.iand(t.value),this}bitwiseAnd(t){return this.clone().ibitwiseAnd(t)}ibitwiseOr(t){return this.value.ior(t.value),this}equal(t){return this.value.eq(t.value)}lt(t){return this.value.lt(t.value)}lte(t){return this.value.lte(t.value)}gt(t){return this.value.gt(t.value)}gte(t){return this.value.gte(t.value)}isZero(){return this.value.isZero()}isOne(){return this.value.eq(new r.B(1))}isNegative(){return this.value.isNeg()}isEven(){return this.value.isEven()}abs(){const t=this.clone();return t.value=t.value.abs(),t}negate(){const t=this.clone();return t.value.ineg(),t}toString(){return this.value.toString()}toNumber(){return this.value.toNumber()}getBit(t){return this.value.testn(t)?1:0}bitLength(){return this.value.bitLength()}byteLength(){return this.value.byteLength()}toUint8Array(t="be",e){return this.value.toArrayLike(Uint8Array,t,e)}}},28036:(t,e,i)=>{i.r(e),i.d(e,{B:()=>s,b:()=>o});
/*! OpenPGP.js v6.0.0-alpha.0 - 2023-12-12 - this is LGPL licensed code, see LICENSE/our website https://openpgpjs.org/ for more information. */
const r="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var n={exports:{}};!function(t,e){function i(t,e){if(!t)throw Error(e||"Assertion failed")}function r(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}function n(t,e,i){if(n.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==e&&"be"!==e||(i=e,e=10),this._init(t||0,e||10,i||"be"))}var s;"object"==typeof t?t.exports=n:e.BN=n,n.BN=n,n.wordSize=26;try{s=require("buffer").Buffer}catch(t){}function o(t,e,i){for(var r=0,n=Math.min(t.length,i),s=e;s<n;s++){var o=t.charCodeAt(s)-48;r<<=4,r|=o>=49&&o<=54?o-49+10:o>=17&&o<=22?o-17+10:15&o}return r}function h(t,e,i,r){for(var n=0,s=Math.min(t.length,i),o=e;o<s;o++){var h=t.charCodeAt(o)-48;n*=r,n+=h>=49?h-49+10:h>=17?h-17+10:h}return n}n.isBN=function(t){return t instanceof n||null!==t&&"object"==typeof t&&t.constructor.wordSize===n.wordSize&&Array.isArray(t.words)},n.max=function(t,e){return t.cmp(e)>0?t:e},n.min=function(t,e){return t.cmp(e)<0?t:e},n.prototype._init=function(t,e,r){if("number"==typeof t)return this._initNumber(t,e,r);if("object"==typeof t)return this._initArray(t,e,r);"hex"===e&&(e=16),i(e===(0|e)&&e>=2&&e<=36);var n=0;"-"===(t=t.toString().replace(/\s+/g,""))[0]&&n++,16===e?this._parseHex(t,n):this._parseBase(t,e,n),"-"===t[0]&&(this.negative=1),this.strip(),"le"===r&&this._initArray(this.toArray(),e,r)},n.prototype._initNumber=function(t,e,r){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(i(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),e,r)},n.prototype._initArray=function(t,e,r){if(i("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var s,o,h=0;if("be"===r)for(n=t.length-1,s=0;n>=0;n-=3)o=t[n]|t[n-1]<<8|t[n-2]<<16,this.words[s]|=o<<h&67108863,this.words[s+1]=o>>>26-h&67108863,(h+=24)>=26&&(h-=26,s++);else if("le"===r)for(n=0,s=0;n<t.length;n+=3)o=t[n]|t[n+1]<<8|t[n+2]<<16,this.words[s]|=o<<h&67108863,this.words[s+1]=o>>>26-h&67108863,(h+=24)>=26&&(h-=26,s++);return this.strip()},n.prototype._parseHex=function(t,e){this.length=Math.ceil((t.length-e)/6),this.words=Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var r,n,s=0;for(i=t.length-6,r=0;i>=e;i-=6)n=o(t,i,i+6),this.words[r]|=n<<s&67108863,this.words[r+1]|=n>>>26-s&4194303,(s+=24)>=26&&(s-=26,r++);i+6!==e&&(n=o(t,e,i+6),this.words[r]|=n<<s&67108863,this.words[r+1]|=n>>>26-s&4194303),this.strip()},n.prototype._parseBase=function(t,e,i){this.words=[0],this.length=1;for(var r=0,n=1;n<=67108863;n*=e)r++;r--,n=n/e|0;for(var s=t.length-i,o=s%r,f=Math.min(s,s-o)+i,u=0,a=i;a<f;a+=r)u=h(t,a,a+r,e),this.imuln(n),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u);if(0!==o){var l=1;for(u=h(t,a,t.length,e),a=0;a<o;a++)l*=e;this.imuln(l),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u)}},n.prototype.copy=function(t){t.words=Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red},n.prototype.clone=function(){var t=new n(null);return this.copy(t),t},n.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},n.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var f=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],u=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],a=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function l(t,e,i){i.negative=e.negative^t.negative;var r=t.length+e.length|0;i.length=r,r=r-1|0;var n=0|t.words[0],s=0|e.words[0],o=n*s,h=67108863&o,f=o/67108864|0;i.words[0]=h;for(var u=1;u<r;u++){for(var a=f>>>26,l=67108863&f,d=Math.min(u,e.length-1),c=Math.max(0,u-t.length+1);c<=d;c++){var m=u-c|0;a+=(o=(n=0|t.words[m])*(s=0|e.words[c])+l)/67108864|0,l=67108863&o}i.words[u]=0|l,f=0|a}return 0!==f?i.words[u]=0|f:i.length--,i.strip()}n.prototype.toString=function(t,e){var r;if(e=0|e||1,16===(t=t||10)||"hex"===t){r="";for(var n=0,s=0,o=0;o<this.length;o++){var h=this.words[o],l=(16777215&(h<<n|s)).toString(16);r=0!=(s=h>>>24-n&16777215)||o!==this.length-1?f[6-l.length]+l+r:l+r,(n+=2)>=26&&(n-=26,o--)}for(0!==s&&(r=s.toString(16)+r);r.length%e!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(t===(0|t)&&t>=2&&t<=36){var d=u[t],c=a[t];r="";var m=this.clone();for(m.negative=0;!m.isZero();){var p=m.modn(c).toString(t);r=(m=m.idivn(c)).isZero()?p+r:f[d-p.length]+p+r}for(this.isZero()&&(r="0"+r);r.length%e!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}i(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(t,e){return i(void 0!==s),this.toArrayLike(s,t,e)},n.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)},n.prototype.toArrayLike=function(t,e,r){var n=this.byteLength(),s=r||Math.max(1,n);i(n<=s,"byte array longer than desired length"),i(s>0,"Requested array length <= 0"),this.strip();var o,h,f="le"===e,u=new t(s),a=this.clone();if(f){for(h=0;!a.isZero();h++)o=a.andln(255),a.iushrn(8),u[h]=o;for(;h<s;h++)u[h]=0}else{for(h=0;h<s-n;h++)u[h]=0;for(h=0;!a.isZero();h++)o=a.andln(255),a.iushrn(8),u[s-h-1]=o}return u},n.prototype._countBits=Math.clz32?function(t){return 32-Math.clz32(t)}:function(t){var e=t,i=0;return e>=4096&&(i+=13,e>>>=13),e>=64&&(i+=7,e>>>=7),e>=8&&(i+=4,e>>>=4),e>=2&&(i+=2,e>>>=2),i+e},n.prototype._zeroBits=function(t){if(0===t)return 26;var e=t,i=0;return 0==(8191&e)&&(i+=13,e>>>=13),0==(127&e)&&(i+=7,e>>>=7),0==(15&e)&&(i+=4,e>>>=4),0==(3&e)&&(i+=2,e>>>=2),0==(1&e)&&i++,i},n.prototype.bitLength=function(){var t=this.words[this.length-1],e=this._countBits(t);return 26*(this.length-1)+e},n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var i=this._zeroBits(this.words[e]);if(t+=i,26!==i)break}return t},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},n.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return 0!==this.negative},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this.strip()},n.prototype.ior=function(t){return i(0==(this.negative|t.negative)),this.iuor(t)},n.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},n.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},n.prototype.iuand=function(t){var e;e=this.length>t.length?t:this;for(var i=0;i<e.length;i++)this.words[i]=this.words[i]&t.words[i];return this.length=e.length,this.strip()},n.prototype.iand=function(t){return i(0==(this.negative|t.negative)),this.iuand(t)},n.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},n.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},n.prototype.iuxor=function(t){var e,i;this.length>t.length?(e=this,i=t):(e=t,i=this);for(var r=0;r<i.length;r++)this.words[r]=e.words[r]^i.words[r];if(this!==e)for(;r<e.length;r++)this.words[r]=e.words[r];return this.length=e.length,this.strip()},n.prototype.ixor=function(t){return i(0==(this.negative|t.negative)),this.iuxor(t)},n.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},n.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},n.prototype.inotn=function(t){i("number"==typeof t&&t>=0);var e=0|Math.ceil(t/26),r=t%26;this._expand(e),r>0&&e--;for(var n=0;n<e;n++)this.words[n]=67108863&~this.words[n];return r>0&&(this.words[n]=~this.words[n]&67108863>>26-r),this.strip()},n.prototype.notn=function(t){return this.clone().inotn(t)},n.prototype.setn=function(t,e){i("number"==typeof t&&t>=0);var r=t/26|0,n=t%26;return this._expand(r+1),this.words[r]=e?this.words[r]|1<<n:this.words[r]&~(1<<n),this.strip()},n.prototype.iadd=function(t){var e,i,r;if(0!==this.negative&&0===t.negative)return this.negative=0,e=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,e=this.isub(t),t.negative=1,e._normSign();this.length>t.length?(i=this,r=t):(i=t,r=this);for(var n=0,s=0;s<r.length;s++)e=(0|i.words[s])+(0|r.words[s])+n,this.words[s]=67108863&e,n=e>>>26;for(;0!==n&&s<i.length;s++)e=(0|i.words[s])+n,this.words[s]=67108863&e,n=e>>>26;if(this.length=i.length,0!==n)this.words[this.length]=n,this.length++;else if(i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this},n.prototype.add=function(t){var e;return 0!==t.negative&&0===this.negative?(t.negative=0,e=this.sub(t),t.negative^=1,e):0===t.negative&&0!==this.negative?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},n.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var e=this.iadd(t);return t.negative=1,e._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var i,r,n=this.cmp(t);if(0===n)return this.negative=0,this.length=1,this.words[0]=0,this;n>0?(i=this,r=t):(i=t,r=this);for(var s=0,o=0;o<r.length;o++)s=(e=(0|i.words[o])-(0|r.words[o])+s)>>26,this.words[o]=67108863&e;for(;0!==s&&o<i.length;o++)s=(e=(0|i.words[o])+s)>>26,this.words[o]=67108863&e;if(0===s&&o<i.length&&i!==this)for(;o<i.length;o++)this.words[o]=i.words[o];return this.length=Math.max(this.length,o),i!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(t){return this.clone().isub(t)};var d=function(t,e,i){var r,n,s,o=t.words,h=e.words,f=i.words,u=0,a=0|o[0],l=8191&a,d=a>>>13,c=0|o[1],m=8191&c,p=c>>>13,g=0|o[2],w=8191&g,b=g>>>13,v=0|o[3],y=8191&v,M=v>>>13,B=0|o[4],x=8191&B,E=B>>>13,S=0|o[5],A=8191&S,O=S>>>13,L=0|o[6],_=8191&L,I=L>>>13,q=0|o[7],k=8191&q,z=q>>>13,R=0|o[8],N=8191&R,H=R>>>13,U=0|o[9],Z=8191&U,j=U>>>13,F=0|h[0],T=8191&F,C=F>>>13,P=0|h[1],G=8191&P,D=P>>>13,V=0|h[2],$=8191&V,K=V>>>13,W=0|h[3],Y=8191&W,X=W>>>13,J=0|h[4],Q=8191&J,tt=J>>>13,et=0|h[5],it=8191&et,rt=et>>>13,nt=0|h[6],st=8191&nt,ot=nt>>>13,ht=0|h[7],ft=8191&ht,ut=ht>>>13,at=0|h[8],lt=8191&at,dt=at>>>13,ct=0|h[9],mt=8191&ct,pt=ct>>>13;i.negative=t.negative^e.negative,i.length=19;var gt=(u+(r=Math.imul(l,T))|0)+((8191&(n=(n=Math.imul(l,C))+Math.imul(d,T)|0))<<13)|0;u=((s=Math.imul(d,C))+(n>>>13)|0)+(gt>>>26)|0,gt&=67108863,r=Math.imul(m,T),n=(n=Math.imul(m,C))+Math.imul(p,T)|0,s=Math.imul(p,C);var wt=(u+(r=r+Math.imul(l,G)|0)|0)+((8191&(n=(n=n+Math.imul(l,D)|0)+Math.imul(d,G)|0))<<13)|0;u=((s=s+Math.imul(d,D)|0)+(n>>>13)|0)+(wt>>>26)|0,wt&=67108863,r=Math.imul(w,T),n=(n=Math.imul(w,C))+Math.imul(b,T)|0,s=Math.imul(b,C),r=r+Math.imul(m,G)|0,n=(n=n+Math.imul(m,D)|0)+Math.imul(p,G)|0,s=s+Math.imul(p,D)|0;var bt=(u+(r=r+Math.imul(l,$)|0)|0)+((8191&(n=(n=n+Math.imul(l,K)|0)+Math.imul(d,$)|0))<<13)|0;u=((s=s+Math.imul(d,K)|0)+(n>>>13)|0)+(bt>>>26)|0,bt&=67108863,r=Math.imul(y,T),n=(n=Math.imul(y,C))+Math.imul(M,T)|0,s=Math.imul(M,C),r=r+Math.imul(w,G)|0,n=(n=n+Math.imul(w,D)|0)+Math.imul(b,G)|0,s=s+Math.imul(b,D)|0,r=r+Math.imul(m,$)|0,n=(n=n+Math.imul(m,K)|0)+Math.imul(p,$)|0,s=s+Math.imul(p,K)|0;var vt=(u+(r=r+Math.imul(l,Y)|0)|0)+((8191&(n=(n=n+Math.imul(l,X)|0)+Math.imul(d,Y)|0))<<13)|0;u=((s=s+Math.imul(d,X)|0)+(n>>>13)|0)+(vt>>>26)|0,vt&=67108863,r=Math.imul(x,T),n=(n=Math.imul(x,C))+Math.imul(E,T)|0,s=Math.imul(E,C),r=r+Math.imul(y,G)|0,n=(n=n+Math.imul(y,D)|0)+Math.imul(M,G)|0,s=s+Math.imul(M,D)|0,r=r+Math.imul(w,$)|0,n=(n=n+Math.imul(w,K)|0)+Math.imul(b,$)|0,s=s+Math.imul(b,K)|0,r=r+Math.imul(m,Y)|0,n=(n=n+Math.imul(m,X)|0)+Math.imul(p,Y)|0,s=s+Math.imul(p,X)|0;var yt=(u+(r=r+Math.imul(l,Q)|0)|0)+((8191&(n=(n=n+Math.imul(l,tt)|0)+Math.imul(d,Q)|0))<<13)|0;u=((s=s+Math.imul(d,tt)|0)+(n>>>13)|0)+(yt>>>26)|0,yt&=67108863,r=Math.imul(A,T),n=(n=Math.imul(A,C))+Math.imul(O,T)|0,s=Math.imul(O,C),r=r+Math.imul(x,G)|0,n=(n=n+Math.imul(x,D)|0)+Math.imul(E,G)|0,s=s+Math.imul(E,D)|0,r=r+Math.imul(y,$)|0,n=(n=n+Math.imul(y,K)|0)+Math.imul(M,$)|0,s=s+Math.imul(M,K)|0,r=r+Math.imul(w,Y)|0,n=(n=n+Math.imul(w,X)|0)+Math.imul(b,Y)|0,s=s+Math.imul(b,X)|0,r=r+Math.imul(m,Q)|0,n=(n=n+Math.imul(m,tt)|0)+Math.imul(p,Q)|0,s=s+Math.imul(p,tt)|0;var Mt=(u+(r=r+Math.imul(l,it)|0)|0)+((8191&(n=(n=n+Math.imul(l,rt)|0)+Math.imul(d,it)|0))<<13)|0;u=((s=s+Math.imul(d,rt)|0)+(n>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,r=Math.imul(_,T),n=(n=Math.imul(_,C))+Math.imul(I,T)|0,s=Math.imul(I,C),r=r+Math.imul(A,G)|0,n=(n=n+Math.imul(A,D)|0)+Math.imul(O,G)|0,s=s+Math.imul(O,D)|0,r=r+Math.imul(x,$)|0,n=(n=n+Math.imul(x,K)|0)+Math.imul(E,$)|0,s=s+Math.imul(E,K)|0,r=r+Math.imul(y,Y)|0,n=(n=n+Math.imul(y,X)|0)+Math.imul(M,Y)|0,s=s+Math.imul(M,X)|0,r=r+Math.imul(w,Q)|0,n=(n=n+Math.imul(w,tt)|0)+Math.imul(b,Q)|0,s=s+Math.imul(b,tt)|0,r=r+Math.imul(m,it)|0,n=(n=n+Math.imul(m,rt)|0)+Math.imul(p,it)|0,s=s+Math.imul(p,rt)|0;var Bt=(u+(r=r+Math.imul(l,st)|0)|0)+((8191&(n=(n=n+Math.imul(l,ot)|0)+Math.imul(d,st)|0))<<13)|0;u=((s=s+Math.imul(d,ot)|0)+(n>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,r=Math.imul(k,T),n=(n=Math.imul(k,C))+Math.imul(z,T)|0,s=Math.imul(z,C),r=r+Math.imul(_,G)|0,n=(n=n+Math.imul(_,D)|0)+Math.imul(I,G)|0,s=s+Math.imul(I,D)|0,r=r+Math.imul(A,$)|0,n=(n=n+Math.imul(A,K)|0)+Math.imul(O,$)|0,s=s+Math.imul(O,K)|0,r=r+Math.imul(x,Y)|0,n=(n=n+Math.imul(x,X)|0)+Math.imul(E,Y)|0,s=s+Math.imul(E,X)|0,r=r+Math.imul(y,Q)|0,n=(n=n+Math.imul(y,tt)|0)+Math.imul(M,Q)|0,s=s+Math.imul(M,tt)|0,r=r+Math.imul(w,it)|0,n=(n=n+Math.imul(w,rt)|0)+Math.imul(b,it)|0,s=s+Math.imul(b,rt)|0,r=r+Math.imul(m,st)|0,n=(n=n+Math.imul(m,ot)|0)+Math.imul(p,st)|0,s=s+Math.imul(p,ot)|0;var xt=(u+(r=r+Math.imul(l,ft)|0)|0)+((8191&(n=(n=n+Math.imul(l,ut)|0)+Math.imul(d,ft)|0))<<13)|0;u=((s=s+Math.imul(d,ut)|0)+(n>>>13)|0)+(xt>>>26)|0,xt&=67108863,r=Math.imul(N,T),n=(n=Math.imul(N,C))+Math.imul(H,T)|0,s=Math.imul(H,C),r=r+Math.imul(k,G)|0,n=(n=n+Math.imul(k,D)|0)+Math.imul(z,G)|0,s=s+Math.imul(z,D)|0,r=r+Math.imul(_,$)|0,n=(n=n+Math.imul(_,K)|0)+Math.imul(I,$)|0,s=s+Math.imul(I,K)|0,r=r+Math.imul(A,Y)|0,n=(n=n+Math.imul(A,X)|0)+Math.imul(O,Y)|0,s=s+Math.imul(O,X)|0,r=r+Math.imul(x,Q)|0,n=(n=n+Math.imul(x,tt)|0)+Math.imul(E,Q)|0,s=s+Math.imul(E,tt)|0,r=r+Math.imul(y,it)|0,n=(n=n+Math.imul(y,rt)|0)+Math.imul(M,it)|0,s=s+Math.imul(M,rt)|0,r=r+Math.imul(w,st)|0,n=(n=n+Math.imul(w,ot)|0)+Math.imul(b,st)|0,s=s+Math.imul(b,ot)|0,r=r+Math.imul(m,ft)|0,n=(n=n+Math.imul(m,ut)|0)+Math.imul(p,ft)|0,s=s+Math.imul(p,ut)|0;var Et=(u+(r=r+Math.imul(l,lt)|0)|0)+((8191&(n=(n=n+Math.imul(l,dt)|0)+Math.imul(d,lt)|0))<<13)|0;u=((s=s+Math.imul(d,dt)|0)+(n>>>13)|0)+(Et>>>26)|0,Et&=67108863,r=Math.imul(Z,T),n=(n=Math.imul(Z,C))+Math.imul(j,T)|0,s=Math.imul(j,C),r=r+Math.imul(N,G)|0,n=(n=n+Math.imul(N,D)|0)+Math.imul(H,G)|0,s=s+Math.imul(H,D)|0,r=r+Math.imul(k,$)|0,n=(n=n+Math.imul(k,K)|0)+Math.imul(z,$)|0,s=s+Math.imul(z,K)|0,r=r+Math.imul(_,Y)|0,n=(n=n+Math.imul(_,X)|0)+Math.imul(I,Y)|0,s=s+Math.imul(I,X)|0,r=r+Math.imul(A,Q)|0,n=(n=n+Math.imul(A,tt)|0)+Math.imul(O,Q)|0,s=s+Math.imul(O,tt)|0,r=r+Math.imul(x,it)|0,n=(n=n+Math.imul(x,rt)|0)+Math.imul(E,it)|0,s=s+Math.imul(E,rt)|0,r=r+Math.imul(y,st)|0,n=(n=n+Math.imul(y,ot)|0)+Math.imul(M,st)|0,s=s+Math.imul(M,ot)|0,r=r+Math.imul(w,ft)|0,n=(n=n+Math.imul(w,ut)|0)+Math.imul(b,ft)|0,s=s+Math.imul(b,ut)|0,r=r+Math.imul(m,lt)|0,n=(n=n+Math.imul(m,dt)|0)+Math.imul(p,lt)|0,s=s+Math.imul(p,dt)|0;var St=(u+(r=r+Math.imul(l,mt)|0)|0)+((8191&(n=(n=n+Math.imul(l,pt)|0)+Math.imul(d,mt)|0))<<13)|0;u=((s=s+Math.imul(d,pt)|0)+(n>>>13)|0)+(St>>>26)|0,St&=67108863,r=Math.imul(Z,G),n=(n=Math.imul(Z,D))+Math.imul(j,G)|0,s=Math.imul(j,D),r=r+Math.imul(N,$)|0,n=(n=n+Math.imul(N,K)|0)+Math.imul(H,$)|0,s=s+Math.imul(H,K)|0,r=r+Math.imul(k,Y)|0,n=(n=n+Math.imul(k,X)|0)+Math.imul(z,Y)|0,s=s+Math.imul(z,X)|0,r=r+Math.imul(_,Q)|0,n=(n=n+Math.imul(_,tt)|0)+Math.imul(I,Q)|0,s=s+Math.imul(I,tt)|0,r=r+Math.imul(A,it)|0,n=(n=n+Math.imul(A,rt)|0)+Math.imul(O,it)|0,s=s+Math.imul(O,rt)|0,r=r+Math.imul(x,st)|0,n=(n=n+Math.imul(x,ot)|0)+Math.imul(E,st)|0,s=s+Math.imul(E,ot)|0,r=r+Math.imul(y,ft)|0,n=(n=n+Math.imul(y,ut)|0)+Math.imul(M,ft)|0,s=s+Math.imul(M,ut)|0,r=r+Math.imul(w,lt)|0,n=(n=n+Math.imul(w,dt)|0)+Math.imul(b,lt)|0,s=s+Math.imul(b,dt)|0;var At=(u+(r=r+Math.imul(m,mt)|0)|0)+((8191&(n=(n=n+Math.imul(m,pt)|0)+Math.imul(p,mt)|0))<<13)|0;u=((s=s+Math.imul(p,pt)|0)+(n>>>13)|0)+(At>>>26)|0,At&=67108863,r=Math.imul(Z,$),n=(n=Math.imul(Z,K))+Math.imul(j,$)|0,s=Math.imul(j,K),r=r+Math.imul(N,Y)|0,n=(n=n+Math.imul(N,X)|0)+Math.imul(H,Y)|0,s=s+Math.imul(H,X)|0,r=r+Math.imul(k,Q)|0,n=(n=n+Math.imul(k,tt)|0)+Math.imul(z,Q)|0,s=s+Math.imul(z,tt)|0,r=r+Math.imul(_,it)|0,n=(n=n+Math.imul(_,rt)|0)+Math.imul(I,it)|0,s=s+Math.imul(I,rt)|0,r=r+Math.imul(A,st)|0,n=(n=n+Math.imul(A,ot)|0)+Math.imul(O,st)|0,s=s+Math.imul(O,ot)|0,r=r+Math.imul(x,ft)|0,n=(n=n+Math.imul(x,ut)|0)+Math.imul(E,ft)|0,s=s+Math.imul(E,ut)|0,r=r+Math.imul(y,lt)|0,n=(n=n+Math.imul(y,dt)|0)+Math.imul(M,lt)|0,s=s+Math.imul(M,dt)|0;var Ot=(u+(r=r+Math.imul(w,mt)|0)|0)+((8191&(n=(n=n+Math.imul(w,pt)|0)+Math.imul(b,mt)|0))<<13)|0;u=((s=s+Math.imul(b,pt)|0)+(n>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,r=Math.imul(Z,Y),n=(n=Math.imul(Z,X))+Math.imul(j,Y)|0,s=Math.imul(j,X),r=r+Math.imul(N,Q)|0,n=(n=n+Math.imul(N,tt)|0)+Math.imul(H,Q)|0,s=s+Math.imul(H,tt)|0,r=r+Math.imul(k,it)|0,n=(n=n+Math.imul(k,rt)|0)+Math.imul(z,it)|0,s=s+Math.imul(z,rt)|0,r=r+Math.imul(_,st)|0,n=(n=n+Math.imul(_,ot)|0)+Math.imul(I,st)|0,s=s+Math.imul(I,ot)|0,r=r+Math.imul(A,ft)|0,n=(n=n+Math.imul(A,ut)|0)+Math.imul(O,ft)|0,s=s+Math.imul(O,ut)|0,r=r+Math.imul(x,lt)|0,n=(n=n+Math.imul(x,dt)|0)+Math.imul(E,lt)|0,s=s+Math.imul(E,dt)|0;var Lt=(u+(r=r+Math.imul(y,mt)|0)|0)+((8191&(n=(n=n+Math.imul(y,pt)|0)+Math.imul(M,mt)|0))<<13)|0;u=((s=s+Math.imul(M,pt)|0)+(n>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,r=Math.imul(Z,Q),n=(n=Math.imul(Z,tt))+Math.imul(j,Q)|0,s=Math.imul(j,tt),r=r+Math.imul(N,it)|0,n=(n=n+Math.imul(N,rt)|0)+Math.imul(H,it)|0,s=s+Math.imul(H,rt)|0,r=r+Math.imul(k,st)|0,n=(n=n+Math.imul(k,ot)|0)+Math.imul(z,st)|0,s=s+Math.imul(z,ot)|0,r=r+Math.imul(_,ft)|0,n=(n=n+Math.imul(_,ut)|0)+Math.imul(I,ft)|0,s=s+Math.imul(I,ut)|0,r=r+Math.imul(A,lt)|0,n=(n=n+Math.imul(A,dt)|0)+Math.imul(O,lt)|0,s=s+Math.imul(O,dt)|0;var _t=(u+(r=r+Math.imul(x,mt)|0)|0)+((8191&(n=(n=n+Math.imul(x,pt)|0)+Math.imul(E,mt)|0))<<13)|0;u=((s=s+Math.imul(E,pt)|0)+(n>>>13)|0)+(_t>>>26)|0,_t&=67108863,r=Math.imul(Z,it),n=(n=Math.imul(Z,rt))+Math.imul(j,it)|0,s=Math.imul(j,rt),r=r+Math.imul(N,st)|0,n=(n=n+Math.imul(N,ot)|0)+Math.imul(H,st)|0,s=s+Math.imul(H,ot)|0,r=r+Math.imul(k,ft)|0,n=(n=n+Math.imul(k,ut)|0)+Math.imul(z,ft)|0,s=s+Math.imul(z,ut)|0,r=r+Math.imul(_,lt)|0,n=(n=n+Math.imul(_,dt)|0)+Math.imul(I,lt)|0,s=s+Math.imul(I,dt)|0;var It=(u+(r=r+Math.imul(A,mt)|0)|0)+((8191&(n=(n=n+Math.imul(A,pt)|0)+Math.imul(O,mt)|0))<<13)|0;u=((s=s+Math.imul(O,pt)|0)+(n>>>13)|0)+(It>>>26)|0,It&=67108863,r=Math.imul(Z,st),n=(n=Math.imul(Z,ot))+Math.imul(j,st)|0,s=Math.imul(j,ot),r=r+Math.imul(N,ft)|0,n=(n=n+Math.imul(N,ut)|0)+Math.imul(H,ft)|0,s=s+Math.imul(H,ut)|0,r=r+Math.imul(k,lt)|0,n=(n=n+Math.imul(k,dt)|0)+Math.imul(z,lt)|0,s=s+Math.imul(z,dt)|0;var qt=(u+(r=r+Math.imul(_,mt)|0)|0)+((8191&(n=(n=n+Math.imul(_,pt)|0)+Math.imul(I,mt)|0))<<13)|0;u=((s=s+Math.imul(I,pt)|0)+(n>>>13)|0)+(qt>>>26)|0,qt&=67108863,r=Math.imul(Z,ft),n=(n=Math.imul(Z,ut))+Math.imul(j,ft)|0,s=Math.imul(j,ut),r=r+Math.imul(N,lt)|0,n=(n=n+Math.imul(N,dt)|0)+Math.imul(H,lt)|0,s=s+Math.imul(H,dt)|0;var kt=(u+(r=r+Math.imul(k,mt)|0)|0)+((8191&(n=(n=n+Math.imul(k,pt)|0)+Math.imul(z,mt)|0))<<13)|0;u=((s=s+Math.imul(z,pt)|0)+(n>>>13)|0)+(kt>>>26)|0,kt&=67108863,r=Math.imul(Z,lt),n=(n=Math.imul(Z,dt))+Math.imul(j,lt)|0,s=Math.imul(j,dt);var zt=(u+(r=r+Math.imul(N,mt)|0)|0)+((8191&(n=(n=n+Math.imul(N,pt)|0)+Math.imul(H,mt)|0))<<13)|0;u=((s=s+Math.imul(H,pt)|0)+(n>>>13)|0)+(zt>>>26)|0,zt&=67108863;var Rt=(u+(r=Math.imul(Z,mt))|0)+((8191&(n=(n=Math.imul(Z,pt))+Math.imul(j,mt)|0))<<13)|0;return u=((s=Math.imul(j,pt))+(n>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,f[0]=gt,f[1]=wt,f[2]=bt,f[3]=vt,f[4]=yt,f[5]=Mt,f[6]=Bt,f[7]=xt,f[8]=Et,f[9]=St,f[10]=At,f[11]=Ot,f[12]=Lt,f[13]=_t,f[14]=It,f[15]=qt,f[16]=kt,f[17]=zt,f[18]=Rt,0!==u&&(f[19]=u,i.length++),i};function c(t,e,i){return(new m).mulp(t,e,i)}function m(t,e){this.x=t,this.y=e}Math.imul||(d=l),n.prototype.mulTo=function(t,e){var i,r=this.length+t.length;return i=10===this.length&&10===t.length?d(this,t,e):r<63?l(this,t,e):r<1024?function(t,e,i){i.negative=e.negative^t.negative,i.length=t.length+e.length;for(var r=0,n=0,s=0;s<i.length-1;s++){var o=n;n=0;for(var h=67108863&r,f=Math.min(s,e.length-1),u=Math.max(0,s-t.length+1);u<=f;u++){var a=s-u,l=(0|t.words[a])*(0|e.words[u]),d=67108863&l;h=67108863&(d=d+h|0),n+=(o=(o=o+(l/67108864|0)|0)+(d>>>26)|0)>>>26,o&=67108863}i.words[s]=h,r=o,o=n}return 0!==r?i.words[s]=r:i.length--,i.strip()}(this,t,e):c(this,t,e),i},m.prototype.makeRBT=function(t){for(var e=Array(t),i=n.prototype._countBits(t)-1,r=0;r<t;r++)e[r]=this.revBin(r,i,t);return e},m.prototype.revBin=function(t,e,i){if(0===t||t===i-1)return t;for(var r=0,n=0;n<e;n++)r|=(1&t)<<e-n-1,t>>=1;return r},m.prototype.permute=function(t,e,i,r,n,s){for(var o=0;o<s;o++)r[o]=e[t[o]],n[o]=i[t[o]]},m.prototype.transform=function(t,e,i,r,n,s){this.permute(s,t,e,i,r,n);for(var o=1;o<n;o<<=1)for(var h=o<<1,f=Math.cos(2*Math.PI/h),u=Math.sin(2*Math.PI/h),a=0;a<n;a+=h)for(var l=f,d=u,c=0;c<o;c++){var m=i[a+c],p=r[a+c],g=i[a+c+o],w=r[a+c+o],b=l*g-d*w;w=l*w+d*g,g=b,i[a+c]=m+g,r[a+c]=p+w,i[a+c+o]=m-g,r[a+c+o]=p-w,c!==h&&(b=f*l-u*d,d=f*d+u*l,l=b)}},m.prototype.guessLen13b=function(t,e){var i=1|Math.max(e,t),r=1&i,n=0;for(i=i/2|0;i;i>>>=1)n++;return 1<<n+1+r},m.prototype.conjugate=function(t,e,i){if(!(i<=1))for(var r=0;r<i/2;r++){var n=t[r];t[r]=t[i-r-1],t[i-r-1]=n,n=e[r],e[r]=-e[i-r-1],e[i-r-1]=-n}},m.prototype.normalize13b=function(t,e){for(var i=0,r=0;r<e/2;r++){var n=8192*Math.round(t[2*r+1]/e)+Math.round(t[2*r]/e)+i;t[r]=67108863&n,i=n<67108864?0:n/67108864|0}return t},m.prototype.convert13b=function(t,e,r,n){for(var s=0,o=0;o<e;o++)s+=0|t[o],r[2*o]=8191&s,s>>>=13,r[2*o+1]=8191&s,s>>>=13;for(o=2*e;o<n;++o)r[o]=0;i(0===s),i(0==(-8192&s))},m.prototype.stub=function(t){for(var e=Array(t),i=0;i<t;i++)e[i]=0;return e},m.prototype.mulp=function(t,e,i){var r=2*this.guessLen13b(t.length,e.length),n=this.makeRBT(r),s=this.stub(r),o=Array(r),h=Array(r),f=Array(r),u=Array(r),a=Array(r),l=Array(r),d=i.words;d.length=r,this.convert13b(t.words,t.length,o,r),this.convert13b(e.words,e.length,u,r),this.transform(o,s,h,f,r,n),this.transform(u,s,a,l,r,n);for(var c=0;c<r;c++){var m=h[c]*a[c]-f[c]*l[c];f[c]=h[c]*l[c]+f[c]*a[c],h[c]=m}return this.conjugate(h,f,r),this.transform(h,f,d,s,r,n),this.conjugate(d,s,r),this.normalize13b(d,r),i.negative=t.negative^e.negative,i.length=t.length+e.length,i.strip()},n.prototype.mul=function(t){var e=new n(null);return e.words=Array(this.length+t.length),this.mulTo(t,e)},n.prototype.mulf=function(t){var e=new n(null);return e.words=Array(this.length+t.length),c(this,t,e)},n.prototype.imul=function(t){return this.clone().mulTo(t,this)},n.prototype.imuln=function(t){i("number"==typeof t),i(t<67108864);for(var e=0,r=0;r<this.length;r++){var n=(0|this.words[r])*t,s=(67108863&n)+(67108863&e);e>>=26,e+=n/67108864|0,e+=s>>>26,this.words[r]=67108863&s}return 0!==e&&(this.words[r]=e,this.length++),this},n.prototype.muln=function(t){return this.clone().imuln(t)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(t){var e=function(t){for(var e=Array(t.bitLength()),i=0;i<e.length;i++){var r=i/26|0,n=i%26;e[i]=(t.words[r]&1<<n)>>>n}return e}(t);if(0===e.length)return new n(1);for(var i=this,r=0;r<e.length&&0===e[r];r++,i=i.sqr());if(++r<e.length)for(var s=i.sqr();r<e.length;r++,s=s.sqr())0!==e[r]&&(i=i.mul(s));return i},n.prototype.iushln=function(t){i("number"==typeof t&&t>=0);var e,r=t%26,n=(t-r)/26,s=67108863>>>26-r<<26-r;if(0!==r){var o=0;for(e=0;e<this.length;e++){var h=this.words[e]&s,f=(0|this.words[e])-h<<r;this.words[e]=f|o,o=h>>>26-r}o&&(this.words[e]=o,this.length++)}if(0!==n){for(e=this.length-1;e>=0;e--)this.words[e+n]=this.words[e];for(e=0;e<n;e++)this.words[e]=0;this.length+=n}return this.strip()},n.prototype.ishln=function(t){return i(0===this.negative),this.iushln(t)},n.prototype.iushrn=function(t,e,r){var n;i("number"==typeof t&&t>=0),n=e?(e-e%26)/26:0;var s=t%26,o=Math.min((t-s)/26,this.length),h=67108863^67108863>>>s<<s,f=r;if(n=Math.max(0,n-=o),f){for(var u=0;u<o;u++)f.words[u]=this.words[u];f.length=o}if(0===o);else if(this.length>o)for(this.length-=o,u=0;u<this.length;u++)this.words[u]=this.words[u+o];else this.words[0]=0,this.length=1;var a=0;for(u=this.length-1;u>=0&&(0!==a||u>=n);u--){var l=0|this.words[u];this.words[u]=a<<26-s|l>>>s,a=l&h}return f&&0!==a&&(f.words[f.length++]=a),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(t,e,r){return i(0===this.negative),this.iushrn(t,e,r)},n.prototype.shln=function(t){return this.clone().ishln(t)},n.prototype.ushln=function(t){return this.clone().iushln(t)},n.prototype.shrn=function(t){return this.clone().ishrn(t)},n.prototype.ushrn=function(t){return this.clone().iushrn(t)},n.prototype.testn=function(t){i("number"==typeof t&&t>=0);var e=t%26,r=(t-e)/26,n=1<<e;return!(this.length<=r||!(this.words[r]&n))},n.prototype.imaskn=function(t){i("number"==typeof t&&t>=0);var e=t%26,r=(t-e)/26;if(i(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==e&&r++,this.length=Math.min(r,this.length),0!==e){var n=67108863^67108863>>>e<<e;this.words[this.length-1]&=n}return this.strip()},n.prototype.maskn=function(t){return this.clone().imaskn(t)},n.prototype.iaddn=function(t){return i("number"==typeof t),i(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},n.prototype._iaddn=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},n.prototype.isubn=function(t){if(i("number"==typeof t),i(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this.strip()},n.prototype.addn=function(t){return this.clone().iaddn(t)},n.prototype.subn=function(t){return this.clone().isubn(t)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(t,e,r){var n,s,o=t.length+r;this._expand(o);var h=0;for(n=0;n<t.length;n++){s=(0|this.words[n+r])+h;var f=(0|t.words[n])*e;h=((s-=67108863&f)>>26)-(f/67108864|0),this.words[n+r]=67108863&s}for(;n<this.length-r;n++)h=(s=(0|this.words[n+r])+h)>>26,this.words[n+r]=67108863&s;if(0===h)return this.strip();for(i(-1===h),h=0,n=0;n<this.length;n++)h=(s=-(0|this.words[n])+h)>>26,this.words[n]=67108863&s;return this.negative=1,this.strip()},n.prototype._wordDiv=function(t,e){var i=(this.length,t.length),r=this.clone(),s=t,o=0|s.words[s.length-1];0!=(i=26-this._countBits(o))&&(s=s.ushln(i),r.iushln(i),o=0|s.words[s.length-1]);var h,f=r.length-s.length;if("mod"!==e){(h=new n(null)).length=f+1,h.words=Array(h.length);for(var u=0;u<h.length;u++)h.words[u]=0}var a=r.clone()._ishlnsubmul(s,1,f);0===a.negative&&(r=a,h&&(h.words[f]=1));for(var l=f-1;l>=0;l--){var d=67108864*(0|r.words[s.length+l])+(0|r.words[s.length+l-1]);for(d=Math.min(d/o|0,67108863),r._ishlnsubmul(s,d,l);0!==r.negative;)d--,r.negative=0,r._ishlnsubmul(s,1,l),r.isZero()||(r.negative^=1);h&&(h.words[l]=d)}return h&&h.strip(),r.strip(),"div"!==e&&0!==i&&r.iushrn(i),{div:h||null,mod:r}},n.prototype.divmod=function(t,e,r){return i(!t.isZero()),this.isZero()?{div:new n(0),mod:new n(0)}:0!==this.negative&&0===t.negative?(h=this.neg().divmod(t,e),"mod"!==e&&(s=h.div.neg()),"div"!==e&&(o=h.mod.neg(),r&&0!==o.negative&&o.iadd(t)),{div:s,mod:o}):0===this.negative&&0!==t.negative?(h=this.divmod(t.neg(),e),"mod"!==e&&(s=h.div.neg()),{div:s,mod:h.mod}):0!=(this.negative&t.negative)?(h=this.neg().divmod(t.neg(),e),"div"!==e&&(o=h.mod.neg(),r&&0!==o.negative&&o.isub(t)),{div:h.div,mod:o}):t.length>this.length||this.cmp(t)<0?{div:new n(0),mod:this}:1===t.length?"div"===e?{div:this.divn(t.words[0]),mod:null}:"mod"===e?{div:null,mod:new n(this.modn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new n(this.modn(t.words[0]))}:this._wordDiv(t,e);var s,o,h},n.prototype.div=function(t){return this.divmod(t,"div",!1).div},n.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},n.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},n.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var i=0!==e.div.negative?e.mod.isub(t):e.mod,r=t.ushrn(1),n=t.andln(1),s=i.cmp(r);return s<0||1===n&&0===s?e.div:0!==e.div.negative?e.div.isubn(1):e.div.iaddn(1)},n.prototype.modn=function(t){i(t<=67108863);for(var e=(1<<26)%t,r=0,n=this.length-1;n>=0;n--)r=(e*r+(0|this.words[n]))%t;return r},n.prototype.idivn=function(t){i(t<=67108863);for(var e=0,r=this.length-1;r>=0;r--){var n=(0|this.words[r])+67108864*e;this.words[r]=n/t|0,e=n%t}return this.strip()},n.prototype.divn=function(t){return this.clone().idivn(t)},n.prototype.egcd=function(t){i(0===t.negative),i(!t.isZero());var e=this,r=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var s=new n(1),o=new n(0),h=new n(0),f=new n(1),u=0;e.isEven()&&r.isEven();)e.iushrn(1),r.iushrn(1),++u;for(var a=r.clone(),l=e.clone();!e.isZero();){for(var d=0,c=1;0==(e.words[0]&c)&&d<26;++d,c<<=1);if(d>0)for(e.iushrn(d);d-- >0;)(s.isOdd()||o.isOdd())&&(s.iadd(a),o.isub(l)),s.iushrn(1),o.iushrn(1);for(var m=0,p=1;0==(r.words[0]&p)&&m<26;++m,p<<=1);if(m>0)for(r.iushrn(m);m-- >0;)(h.isOdd()||f.isOdd())&&(h.iadd(a),f.isub(l)),h.iushrn(1),f.iushrn(1);e.cmp(r)>=0?(e.isub(r),s.isub(h),o.isub(f)):(r.isub(e),h.isub(s),f.isub(o))}return{a:h,b:f,gcd:r.iushln(u)}},n.prototype._invmp=function(t){i(0===t.negative),i(!t.isZero());var e=this,r=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var s,o=new n(1),h=new n(0),f=r.clone();e.cmpn(1)>0&&r.cmpn(1)>0;){for(var u=0,a=1;0==(e.words[0]&a)&&u<26;++u,a<<=1);if(u>0)for(e.iushrn(u);u-- >0;)o.isOdd()&&o.iadd(f),o.iushrn(1);for(var l=0,d=1;0==(r.words[0]&d)&&l<26;++l,d<<=1);if(l>0)for(r.iushrn(l);l-- >0;)h.isOdd()&&h.iadd(f),h.iushrn(1);e.cmp(r)>=0?(e.isub(r),o.isub(h)):(r.isub(e),h.isub(o))}return(s=0===e.cmpn(1)?o:h).cmpn(0)<0&&s.iadd(t),s},n.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),i=t.clone();e.negative=0,i.negative=0;for(var r=0;e.isEven()&&i.isEven();r++)e.iushrn(1),i.iushrn(1);for(;;){for(;e.isEven();)e.iushrn(1);for(;i.isEven();)i.iushrn(1);var n=e.cmp(i);if(n<0){var s=e;e=i,i=s}else if(0===n||0===i.cmpn(1))break;e.isub(i)}return i.iushln(r)},n.prototype.invm=function(t){return this.egcd(t).a.umod(t)},n.prototype.isEven=function(){return 0==(1&this.words[0])},n.prototype.isOdd=function(){return 1==(1&this.words[0])},n.prototype.andln=function(t){return this.words[0]&t},n.prototype.bincn=function(t){i("number"==typeof t);var e=t%26,r=(t-e)/26,n=1<<e;if(this.length<=r)return this._expand(r+1),this.words[r]|=n,this;for(var s=n,o=r;0!==s&&o<this.length;o++){var h=0|this.words[o];s=(h+=s)>>>26,h&=67108863,this.words[o]=h}return 0!==s&&(this.words[o]=s,this.length++),this},n.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},n.prototype.cmpn=function(t){var e,r=t<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this.strip(),this.length>1)e=1;else{r&&(t=-t),i(t<=67108863,"Number is too big");var n=0|this.words[0];e=n===t?0:n<t?-1:1}return 0!==this.negative?0|-e:e},n.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var e=this.ucmp(t);return 0!==this.negative?0|-e:e},n.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var e=0,i=this.length-1;i>=0;i--){var r=0|this.words[i],n=0|t.words[i];if(r!==n){r<n?e=-1:r>n&&(e=1);break}}return e},n.prototype.gtn=function(t){return 1===this.cmpn(t)},n.prototype.gt=function(t){return 1===this.cmp(t)},n.prototype.gten=function(t){return this.cmpn(t)>=0},n.prototype.gte=function(t){return this.cmp(t)>=0},n.prototype.ltn=function(t){return-1===this.cmpn(t)},n.prototype.lt=function(t){return-1===this.cmp(t)},n.prototype.lten=function(t){return this.cmpn(t)<=0},n.prototype.lte=function(t){return this.cmp(t)<=0},n.prototype.eqn=function(t){return 0===this.cmpn(t)},n.prototype.eq=function(t){return 0===this.cmp(t)},n.red=function(t){return new M(t)},n.prototype.toRed=function(t){return i(!this.red,"Already a number in reduction context"),i(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},n.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(t){return this.red=t,this},n.prototype.forceRed=function(t){return i(!this.red,"Already a number in reduction context"),this._forceRed(t)},n.prototype.redAdd=function(t){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},n.prototype.redIAdd=function(t){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},n.prototype.redSub=function(t){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},n.prototype.redISub=function(t){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},n.prototype.redShl=function(t){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},n.prototype.redMul=function(t){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},n.prototype.redIMul=function(t){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},n.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(t){return i(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var p={k256:null,p224:null,p192:null,p25519:null};function g(t,e){this.name=t,this.p=new n(e,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function w(){g.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function b(){g.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function v(){g.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function y(){g.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function M(t){if("string"==typeof t){var e=n._prime(t);this.m=e.p,this.prime=e}else i(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function B(t){M.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}g.prototype._tmp=function(){var t=new n(null);return t.words=Array(Math.ceil(this.n/13)),t},g.prototype.ireduce=function(t){var e,i=t;do{this.split(i,this.tmp),e=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(e>this.n);var r=e<this.n?-1:i.ucmp(this.p);return 0===r?(i.words[0]=0,i.length=1):r>0?i.isub(this.p):i.strip(),i},g.prototype.split=function(t,e){t.iushrn(this.n,0,e)},g.prototype.imulK=function(t){return t.imul(this.k)},r(w,g),w.prototype.split=function(t,e){for(var i=4194303,r=Math.min(t.length,9),n=0;n<r;n++)e.words[n]=t.words[n];if(e.length=r,t.length<=9)return t.words[0]=0,void(t.length=1);var s=t.words[9];for(e.words[e.length++]=s&i,n=10;n<t.length;n++){var o=0|t.words[n];t.words[n-10]=(o&i)<<4|s>>>22,s=o}s>>>=22,t.words[n-10]=s,0===s&&t.length>10?t.length-=10:t.length-=9},w.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,i=0;i<t.length;i++){var r=0|t.words[i];e+=977*r,t.words[i]=67108863&e,e=64*r+(e/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},r(b,g),r(v,g),r(y,g),y.prototype.imulK=function(t){for(var e=0,i=0;i<t.length;i++){var r=19*(0|t.words[i])+e,n=67108863&r;r>>>=26,t.words[i]=n,e=r}return 0!==e&&(t.words[t.length++]=e),t},n._prime=function(t){if(p[t])return p[t];var e;if("k256"===t)e=new w;else if("p224"===t)e=new b;else if("p192"===t)e=new v;else{if("p25519"!==t)throw Error("Unknown prime "+t);e=new y}return p[t]=e,e},M.prototype._verify1=function(t){i(0===t.negative,"red works only with positives"),i(t.red,"red works only with red numbers")},M.prototype._verify2=function(t,e){i(0==(t.negative|e.negative),"red works only with positives"),i(t.red&&t.red===e.red,"red works only with red numbers")},M.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):t.umod(this.m)._forceRed(this)},M.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},M.prototype.add=function(t,e){this._verify2(t,e);var i=t.add(e);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},M.prototype.iadd=function(t,e){this._verify2(t,e);var i=t.iadd(e);return i.cmp(this.m)>=0&&i.isub(this.m),i},M.prototype.sub=function(t,e){this._verify2(t,e);var i=t.sub(e);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},M.prototype.isub=function(t,e){this._verify2(t,e);var i=t.isub(e);return i.cmpn(0)<0&&i.iadd(this.m),i},M.prototype.shl=function(t,e){return this._verify1(t),this.imod(t.ushln(e))},M.prototype.imul=function(t,e){return this._verify2(t,e),this.imod(t.imul(e))},M.prototype.mul=function(t,e){return this._verify2(t,e),this.imod(t.mul(e))},M.prototype.isqr=function(t){return this.imul(t,t.clone())},M.prototype.sqr=function(t){return this.mul(t,t)},M.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(i(e%2==1),3===e){var r=this.m.add(new n(1)).iushrn(2);return this.pow(t,r)}for(var s=this.m.subn(1),o=0;!s.isZero()&&0===s.andln(1);)o++,s.iushrn(1);i(!s.isZero());var h=new n(1).toRed(this),f=h.redNeg(),u=this.m.subn(1).iushrn(1),a=this.m.bitLength();for(a=new n(2*a*a).toRed(this);0!==this.pow(a,u).cmp(f);)a.redIAdd(f);for(var l=this.pow(a,s),d=this.pow(t,s.addn(1).iushrn(1)),c=this.pow(t,s),m=o;0!==c.cmp(h);){for(var p=c,g=0;0!==p.cmp(h);g++)p=p.redSqr();i(g<m);var w=this.pow(l,new n(1).iushln(m-g-1));d=d.redMul(w),l=w.redSqr(),c=c.redMul(l),m=g}return d},M.prototype.invm=function(t){var e=t._invmp(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},M.prototype.pow=function(t,e){if(e.isZero())return new n(1).toRed(this);if(0===e.cmpn(1))return t.clone();var i=Array(16);i[0]=new n(1).toRed(this),i[1]=t;for(var r=2;r<i.length;r++)i[r]=this.mul(i[r-1],t);var s=i[0],o=0,h=0,f=e.bitLength()%26;for(0===f&&(f=26),r=e.length-1;r>=0;r--){for(var u=e.words[r],a=f-1;a>=0;a--){var l=u>>a&1;s!==i[0]&&(s=this.sqr(s)),0!==l||0!==o?(o<<=1,o|=l,(4==++h||0===r&&0===a)&&(s=this.mul(s,i[o]),h=0,o=0)):h=0}f=26}return s},M.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},M.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},n.mont=function(t){return new B(t)},r(B,M),B.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},B.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},B.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var i=t.imul(e),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=i.isub(r).iushrn(this.shift),s=n;return n.cmp(this.m)>=0?s=n.isub(this.m):n.cmpn(0)<0&&(s=n.iadd(this.m)),s._forceRed(this)},B.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new n(0)._forceRed(this);var i=t.mul(e),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),s=i.isub(r).iushrn(this.shift),o=s;return s.cmp(this.m)>=0?o=s.isub(this.m):s.cmpn(0)<0&&(o=s.iadd(this.m)),o._forceRed(this)},B.prototype.invm=function(t){return this.imod(t._invmp(this.m).mul(this.r2))._forceRed(this)}}(n,void 0!==r?r:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{});var s=function(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}(n.exports),o=Object.freeze({__proto__:null,default:s})},77680:(t,e,i)=>{i.d(e,{B:()=>r}),
/*! OpenPGP.js v6.0.0-alpha.0 - 2023-12-12 - this is LGPL licensed code, see LICENSE/our website https://openpgpjs.org/ for more information. */
"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;class r{static setImplementation(t,e=!1){if(r.Implementation&&!e)throw Error("Implementation already set");r.Implementation=t}static new(t){return new r.Implementation(t)}}},32772:(t,e,i)=>{i.d(e,{default:()=>n});var r=i(77680);
/*! OpenPGP.js v6.0.0-alpha.0 - 2023-12-12 - this is LGPL licensed code, see LICENSE/our website https://openpgpjs.org/ for more information. */"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;class n extends r.B{constructor(t){if(super(),void 0===t)throw Error("Invalid BigInteger input");if(t instanceof Uint8Array){const e="0123456789ABCDEF";let i="";t.forEach((t=>{i+=e[t>>4]+e[15&t]})),this.value=BigInt("0x0"+i)}else this.value=BigInt(t)}clone(){return new n(this.value)}iinc(){return this.value++,this}inc(){return this.clone().iinc()}idec(){return this.value--,this}dec(){return this.clone().idec()}iadd(t){return this.value+=t.value,this}add(t){return this.clone().iadd(t)}isub(t){return this.value-=t.value,this}sub(t){return this.clone().isub(t)}imul(t){return this.value*=t.value,this}mul(t){return this.clone().imul(t)}imod(t){return this.value%=t.value,this.isNegative()&&this.iadd(t),this}mod(t){return this.clone().imod(t)}modExp(t,e){if(e.isZero())throw Error("Modulo cannot be zero");if(e.isOne())return new n(0);if(t.isNegative())throw Error("Unsopported negative exponent");let i=t.value,r=this.value;r%=e.value;let s=BigInt(1);for(;i>BigInt(0);){const t=i&BigInt(1);i>>=BigInt(1);const n=s*r%e.value;s=t?n:s,r=r*r%e.value}return new n(s)}modInv(t){const{gcd:e,x:i}=this._egcd(t);if(!e.isOne())throw Error("Inverse does not exist");return i.add(t).mod(t)}idiv(t){return this.value/=t.value,this}div(t){return this.clone().idiv(t)}_egcd(t){let e=BigInt(0),i=BigInt(1),r=BigInt(1),s=BigInt(0),o=this.abs().value,h=t.abs().value;const f=this.isNegative(),u=t.isNegative();for(;h!==BigInt(0);){const t=o/h;let n=e;e=r-t*e,r=n,n=i,i=s-t*i,s=n,n=h,h=o%h,o=n}return{x:new n(f?-r:r),y:new n(u?-s:s),gcd:new n(o)}}gcd(t){let e=this.value,i=t.value;for(;i!==BigInt(0);){const t=i;i=e%i,e=t}return new n(e)}ileftShift(t){return this.value<<=t.value,this}leftShift(t){return this.clone().ileftShift(t)}irightShift(t){return this.value>>=t.value,this}rightShift(t){return this.clone().irightShift(t)}ixor(t){return this.value^=t.value,this}xor(t){return this.clone().ixor(t)}ibitwiseAnd(t){return this.value&=t.value,this}bitwiseAnd(t){return this.clone().ibitwiseAnd(t)}ibitwiseOr(t){return this.value|=t.value,this}equal(t){return this.value===t.value}lt(t){return this.value<t.value}lte(t){return this.value<=t.value}gt(t){return this.value>t.value}gte(t){return this.value>=t.value}isZero(){return this.value===BigInt(0)}isOne(){return this.value===BigInt(1)}isNegative(){return this.value<BigInt(0)}isEven(){return!(this.value&BigInt(1))}abs(){const t=this.clone();return this.isNegative()&&(t.value=-t.value),t}negate(){const t=this.clone();return t.value=-t.value,t}toString(){return this.value.toString()}toNumber(){const t=Number(this.value);if(t>Number.MAX_SAFE_INTEGER)throw Error("Number can only safely store up to 53 bits");return t}getBit(t){return(this.value>>BigInt(t)&BigInt(1))===BigInt(0)?0:1}bitLength(){const t=new n(0),e=new n(1),i=new n(-1),r=this.isNegative()?i:t;let s=1;const o=this.clone();for(;!o.irightShift(e).equal(r);)s++;return s}byteLength(){const t=new n(0),e=new n(-1),i=this.isNegative()?e:t,r=new n(8);let s=1;const o=this.clone();for(;!o.irightShift(r).equal(i);)s++;return s}toUint8Array(t="be",e){let i=this.value.toString(16);i.length%2==1&&(i="0"+i);const r=i.length/2,n=new Uint8Array(e||r),s=e?e-r:0;let o=0;for(;o<r;)n[o+s]=parseInt(i.slice(2*o,2*o+2),16),o++;return"be"!==t&&n.reverse(),n}}},74584:(t,e,i)=>{i.d(e,{nobleCurves:()=>$t});var r=i(21012),n=i(77680);i(32772),i(31016),i(28036);
/*! OpenPGP.js v6.0.0-alpha.0 - 2023-12-12 - this is LGPL licensed code, see LICENSE/our website https://openpgpjs.org/ for more information. */
"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;class s extends r.H{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,(0,r.h)(t);const i=(0,r.t)(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,s=new Uint8Array(n);s.set(i.length>n?t.create().update(i).digest():i);for(let t=0;t<s.length;t++)s[t]^=54;this.iHash.update(s),this.oHash=t.create();for(let t=0;t<s.length;t++)s[t]^=106;this.oHash.update(s),s.fill(0)}update(t){return(0,r.e)(this),this.iHash.update(t),this}digestInto(t){(0,r.e)(this),(0,r.b)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:i,finished:r,destroyed:n,blockLen:s,outputLen:o}=this;return t.finished=r,t.destroyed=n,t.blockLen=s,t.outputLen=o,t.oHash=e._cloneInto(t.oHash),t.iHash=i._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const o=(t,e,i)=>new s(t,e).update(i).digest();o.create=(t,e)=>new s(t,e)
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */;const h=Object.freeze(n.B.new(2)),f=t=>t instanceof Uint8Array,u=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function a(t){if(!f(t))throw Error("Uint8Array expected");let e="";for(let i=0;i<t.length;i++)e+=u[t[i]];return e}function l(t){const e=t instanceof n.B?a(t.toUint8Array()):t.toString(16);return 1&e.length?"0"+e:e}function d(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw Error("padded hex string expected, got unpadded hex of length "+e);const i=new Uint8Array(e/2);for(let e=0;e<i.length;e++){const r=2*e,n=t.slice(r,r+2),s=Number.parseInt(n,16);if(Number.isNaN(s)||s<0)throw Error("Invalid byte sequence");i[e]=s}return i}function c(t){return n.B.new(t)}function m(t){if(!f(t))throw Error("Uint8Array expected");return n.B.new(t.slice().reverse())}function p(t,e){return t.toUint8Array("be",e)}function g(t,e){return t.toUint8Array("le",e)}function w(t,e,i){let r;if("string"==typeof e)try{r=d(e)}catch(i){throw Error(`${t} must be valid hex string, got "${e}". Cause: ${i}`)}else{if(!f(e))throw Error(t+" must be hex string or Uint8Array");r=new Uint8Array(e)}const n=r.length;if("number"==typeof i&&n!==i)throw Error(`${t} expected ${i} bytes, got ${n}`);return r}function b(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.length),0));let i=0;return t.forEach((t=>{if(!f(t))throw Error("Uint8Array expected");e.set(t,i),i+=t.length})),e}const v=t=>h.leftShift(n.B.new(t-1)).idec(),y=t=>new Uint8Array(t),M=t=>Uint8Array.from(t);function B(t,e,i){if("number"!=typeof t||t<2)throw Error("hashLen must be a number");if("number"!=typeof e||e<2)throw Error("qByteLen must be a number");if("function"!=typeof i)throw Error("hmacFn must be a function");let r=y(t),n=y(t),s=0;const o=()=>{r.fill(1),n.fill(0),s=0},h=(...t)=>i(n,r,...t),f=(t=y())=>{n=h(M([0]),t),r=h(),0!==t.length&&(n=h(M([1]),t),r=h())},u=()=>{if(s++>=1e3)throw Error("drbg: tried 1000 values");let t=0;const i=[];for(;t<e;){r=h();const e=r.slice();i.push(e),t+=r.length}return b(...i)};return(t,e)=>{let i;for(o(),f(t);!(i=e(u()));)f();return o(),i}}const x={BigInteger:t=>t instanceof n.B,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function E(t,e,i={}){const r=(e,i,r)=>{const n=x[i];if("function"!=typeof n)throw Error(`Invalid validator "${i}", expected function`);const s=t[e];if(!(r&&void 0===s||n(s,t)))throw Error(`Invalid param ${e+""}=${s} (${typeof s}), expected ${i}`)};for(const[t,i]of Object.entries(e))r(t,i,!1);for(const[t,e]of Object.entries(i))r(t,e,!0);return t}var S=Object.freeze({__proto__:null,bitGet:(t,e)=>t.getBit(e),bitLen:function(t){return t.bitLength()},bitMask:v,bitSet:(t,e,i)=>{throw Error("unsupported bitSet")},bytesToHex:a,bytesToNumberBE:c,bytesToNumberLE:m,concatBytes:b,createHmacDrbg:B,ensureBytes:w,equalBytes:function(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0},hexToBytes:d,hexToNumber:function(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);return n.B.new(""===t?"0":"0x"+t)},numberToBytesBE:p,numberToBytesLE:g,numberToHexUnpadded:l,numberToVarBytesBE:function(t){return d(l(t))},utf8ToBytes:function(t){if("string"!=typeof t)throw Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))},validateObject:E});
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const A=Object.freeze(n.B.new(0)),O=Object.freeze(n.B.new(1)),L=Object.freeze(n.B.new(2)),_=Object.freeze(n.B.new(3)),I=Object.freeze(n.B.new(4)),q=Object.freeze(n.B.new(5)),k=Object.freeze(n.B.new(8)),z=Object.freeze(n.B.new(9)),R=Object.freeze(n.B.new(16));function N(t,e){return t.mod(e)}function H(t,e,i){return t.modExp(e,i)}function U(t,e,i){return t.modExp(L.leftShift(e.dec()),i)}function Z(t,e){return t.modInv(e)}const j=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function F(t,e){const i=void 0!==e?e:t.bitLength();return{nBitLength:i,nByteLength:Math.ceil(i/8)}}function T(t,e,i=!1,r={}){if(t.lte(A))throw Error("Expected Field ORDER > 0, got "+t);const{nBitLength:s,nByteLength:o}=F(t,e);if(o>2048)throw Error("Field lengths over 2048 bytes are not supported");const h=function(t){if(t.mod(I).equal(_)){const e=t.add(O).irightShift(L);return function(t,i){const r=t.pow(i,e);if(!t.eql(t.sqr(r),i))throw Error("Cannot find square root");return r}}if(t.mod(k).equal(q)){const e=t.sub(q).irightShift(_);return function(t,i){const r=t.mul(i,L),n=t.pow(r,e),s=t.mul(i,n),o=t.mul(t.mul(s,L),n),h=t.mul(s,t.sub(o,t.ONE));if(!t.eql(t.sqr(h),i))throw Error("Cannot find square root");return h}}return t.mod(R).equal(z),function(t){const e=t.dec().rightShift(O);let i=t.dec(),r=n.B.new(0);for(;i.isEven();)i.irightShift(O),r.iinc();let s=n.B.new(2);const o=t.dec();for(;s.lt(t)&&!H(s,e,t).equal(o);)s.iinc();if(r.isOne()){const e=t.inc().irightShift(L);return function(t,i){const r=t.pow(i,e);if(!t.eql(t.sqr(r),i))throw Error("Cannot find square root");return r}}const h=i.inc().irightShift(O);return function(t,o){if(t.eql(t.pow(o,e),t.neg(t.ONE)))throw Error("Cannot find square root");let f=r,u=t.pow(t.mul(t.ONE,s),i),a=t.pow(o,h),l=t.pow(o,i);for(;!t.eql(l,t.ONE);){if(t.eql(l,t.ZERO))return t.ZERO;let e=n.B.new(1);for(let i=t.sqr(l);e.lt(f)&&!t.eql(i,t.ONE);e.iinc())i=t.sqr(i);const i=t.pow(u,O.leftShift(f.sub(e).idec()));u=t.sqr(i),a=t.mul(a,i),l=t.mul(l,u),f=e}return a}}(t)}(t),f=Object.freeze({ORDER:t,BITS:s,BYTES:o,MASK:v(s),ZERO:A,ONE:O,create:e=>N(e,t),isValid:e=>{if(!(e instanceof n.B))throw Error("Invalid field element: expected bigint, got "+typeof e);return A.lte(e)&&e.lt(t)},is0:t=>t.isZero(),isOdd:t=>!t.isEven(),neg:e=>N(e.negate(),t),eql:(t,e)=>t.equal(e),sqr:e=>N(e.mul(e),t),add:(e,i)=>N(e.add(i),t),sub:(e,i)=>N(e.sub(i),t),mul:(e,i)=>N(e.mul(i),t),pow:(t,e)=>function(t,e,i){if(i.isNegative())throw Error("Expected power > 0");if(i.isZero())return t.ONE;if(i.isOne())return e;let r=t.ONE,n=e;for(;i.gt(A);)i.isEven()||(r=t.mul(r,n)),n=t.sqr(n),i=i.rightShift(O);return r}(f,t,e),div:(e,i)=>N(e.mul(Z(i,t)),t),sqrN:t=>t.mul(t),addN:(t,e)=>t.add(e),subN:(t,e)=>t.sub(e),mulN:(t,e)=>t.mul(e),inv:e=>Z(e,t),sqrt:r.sqrt||(t=>h(f,t)),invertBatch:t=>function(t,e){const i=Array(e.length),r=e.reduce(((e,r,n)=>t.is0(r)?e:(i[n]=e,t.mul(e,r))),t.ONE),n=t.inv(r);return e.reduceRight(((e,r,n)=>t.is0(r)?e:(i[n]=t.mul(e,i[n]),t.mul(e,r))),n),i}(f,t),cmov:(t,e,i)=>i?e:t,toBytes:t=>i?g(t,o):p(t,o),fromBytes:t=>{if(t.length!==o)throw Error(`Fp.fromBytes: expected ${o}, got ${t.length}`);return i?m(t):c(t)}});return Object.freeze(f)}function C(t){if(!(t instanceof n.B))throw Error("field order must be bigint");return t.byteLength()}function P(t){const e=C(t);return e+Math.ceil(e/2)}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const G=Object.freeze(n.B.new(0)),D=Object.freeze(n.B.new(1));function V(t,e){const i=(t,e)=>{const i=e.negate();return t?i:e},r=t=>({windows:Math.ceil(e/t)+1,windowSize:2**(t-1)});return{constTimeNegate:i,unsafeLadder(e,i){const r=i.clone();let n=t.ZERO,s=e;for(;r.gt(G);)r.isEven()||(n=n.add(s)),s=s.double(),r.irightShift(D);return n},precomputeWindow(t,e){const{windows:i,windowSize:n}=r(e),s=[];let o=t,h=o;for(let t=0;t<i;t++){h=o,s.push(h);for(let t=1;t<n;t++)h=h.add(o),s.push(h);o=h.double()}return s},wNAF(e,s,o){const h=o.clone(),{windows:f,windowSize:u}=r(e);let a=t.ZERO,l=t.BASE;const d=n.B.new(2**e-1),c=2**e,m=n.B.new(e);for(let t=0;t<f;t++){const e=t*u;let r=h.bitwiseAnd(d).toNumber();h.irightShift(m),r>u&&(r-=c,h.iinc());const n=e,o=e+Math.abs(r)-1,f=t%2!=0,p=r<0;0===r?l=l.add(i(f,s[n])):a=a.add(i(p,s[o]))}return{p:a,f:l}},wNAFCached(t,e,i,r){const n=t._WINDOW_SIZE||1;let s=e.get(t);return s||(s=this.precomputeWindow(t,n),1!==n&&e.set(t,r(s))),this.wNAF(n,s,i)}}}function $(t){return E(t.Fp,j.reduce(((t,e)=>(t[e]="function",t)),{ORDER:"BigInteger",MASK:"BigInteger",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),E(t,{n:"BigInteger",h:"BigInteger",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...F(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const{bytesToNumberBE:K,hexToBytes:W}=S,Y={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(t){const{Err:e}=Y;if(t.length<2||2!==t[0])throw new e("Invalid signature integer tag");const i=t[1],r=t.subarray(2,i+2);if(!i||r.length!==i)throw new e("Invalid signature integer: wrong length");if(128&r[0])throw new e("Invalid signature integer: negative");if(0===r[0]&&!(128&r[1]))throw new e("Invalid signature integer: unnecessary leading zero");return{d:K(r),l:t.subarray(i+2)}},toSig(t){const{Err:e}=Y,i="string"==typeof t?W(t):t;if(!(i instanceof Uint8Array))throw Error("ui8a expected");let r=i.length;if(r<2||48!=i[0])throw new e("Invalid signature tag");if(i[1]!==r-2)throw new e("Invalid signature: incorrect length");const{d:n,l:s}=Y._parseInt(i.subarray(2)),{d:o,l:h}=Y._parseInt(s);if(h.length)throw new e("Invalid signature: left bytes after parsing");return{r:n,s:o}},hexFromSig(t){const e=t=>8&Number.parseInt(t[0],16)?"00"+t:t,i=t=>{const e=t instanceof n.B?a(t.toUint8Array()):t.toString(16);return 1&e.length?"0"+e:e},r=e(i(t.s)),s=e(i(t.r)),o=r.length/2,h=s.length/2,f=i(o),u=i(h);return`30${i(h+o+4)}02${u}${s}02${f}${r}`}},X=Object.freeze(n.B.new(0)),J=Object.freeze(n.B.new(1));Object.freeze(n.B.new(2));const Q=Object.freeze(n.B.new(3));function tt(t){const e=function(t){const e=$(t);return E(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:i,n:r}=e,s=i.BYTES+1,o=2*i.BYTES+1;function h(t){return N(t,r)}function f(t){return Z(t,r)}const{ProjectivePoint:u,normPrivateKeyToScalar:l,weierstrassEquation:y,isWithinCurveOrder:M}=function(t){const e=function(t){const e=$(t);E(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:i,Fp:r,a:s}=e;if(i){if(!r.eql(s,r.ZERO))throw Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof i||!(i.beta instanceof n.B)||"function"!=typeof i.splitScalar)throw Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:i}=e,r=e.toBytes||((t,e,r)=>{const n=e.toAffine();return b(Uint8Array.from([4]),i.toBytes(n.x),i.toBytes(n.y))}),s=e.fromBytes||(t=>{const e=t.subarray(1);return{x:i.fromBytes(e.subarray(0,i.BYTES)),y:i.fromBytes(e.subarray(i.BYTES,2*i.BYTES))}});function o(t){const{a:r,b:n}=e,s=i.sqr(t),o=i.mul(s,t);return i.add(i.add(o,i.mul(t,r)),n)}if(!i.eql(i.sqr(e.Gy),o(e.Gx)))throw Error("bad generator point: equation left != right");function h(t){return t instanceof n.B&&X.lt(t)&&t.lt(e.n)}function f(t){if(!h(t))throw Error("Expected valid bigint: 0 < bigint < curve.n")}function u(t){const{allowedPrivateKeyLengths:i,nByteLength:r,wrapPrivateKey:s,n:o}=e;if(i&&!(t instanceof n.B)){if(t instanceof Uint8Array&&(t=a(t)),"string"!=typeof t||!i.includes(t.length))throw Error("Invalid key");t=t.padStart(2*r,"0")}let h;try{h=t instanceof n.B?t:c(w("private key",t,r))}catch(e){throw Error(`private key must be ${r} bytes, hex or bigint, not ${typeof t}`)}return s&&(h=N(h,o)),f(h),h}const l=new Map;function d(t){if(!(t instanceof m))throw Error("ProjectivePoint expected")}class m{constructor(t,e,r){if(this.px=t,this.py=e,this.pz=r,null==t||!i.isValid(t))throw Error("x required");if(null==e||!i.isValid(e))throw Error("y required");if(null==r||!i.isValid(r))throw Error("z required")}static fromAffine(t){const{x:e,y:r}=t||{};if(!t||!i.isValid(e)||!i.isValid(r))throw Error("invalid affine point");if(t instanceof m)throw Error("projective point not allowed");const n=t=>i.eql(t,i.ZERO);return n(e)&&n(r)?m.ZERO:new m(e,r,i.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){const e=i.invertBatch(t.map((t=>t.pz)));return t.map(((t,i)=>t.toAffine(e[i]))).map(m.fromAffine)}static fromHex(t){const e=m.fromAffine(s(w("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return m.BASE.multiply(u(t))}_setWindowSize(t){this._WINDOW_SIZE=t,l.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!i.is0(this.py))return;throw Error("bad point: ZERO")}const{x:t,y:r}=this.toAffine();if(!i.isValid(t)||!i.isValid(r))throw Error("bad point: x or y not FE");const n=i.sqr(r),s=o(t);if(!i.eql(n,s))throw Error("bad point: equation left != right");if(!this.isTorsionFree())throw Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:t}=this.toAffine();if(i.isOdd)return!i.isOdd(t);throw Error("Field doesn't support isOdd")}equals(t){d(t);const{px:e,py:r,pz:n}=this,{px:s,py:o,pz:h}=t,f=i.eql(i.mul(e,h),i.mul(s,n)),u=i.eql(i.mul(r,h),i.mul(o,n));return f&&u}negate(){return new m(this.px,i.neg(this.py),this.pz)}double(){const{a:t,b:r}=e,n=i.mul(r,Q),{px:s,py:o,pz:h}=this;let f=i.ZERO,u=i.ZERO,a=i.ZERO,l=i.mul(s,s),d=i.mul(o,o),c=i.mul(h,h),p=i.mul(s,o);return p=i.add(p,p),a=i.mul(s,h),a=i.add(a,a),f=i.mul(t,a),u=i.mul(n,c),u=i.add(f,u),f=i.sub(d,u),u=i.add(d,u),u=i.mul(f,u),f=i.mul(p,f),a=i.mul(n,a),c=i.mul(t,c),p=i.sub(l,c),p=i.mul(t,p),p=i.add(p,a),a=i.add(l,l),l=i.add(a,l),l=i.add(l,c),l=i.mul(l,p),u=i.add(u,l),c=i.mul(o,h),c=i.add(c,c),l=i.mul(c,p),f=i.sub(f,l),a=i.mul(c,d),a=i.add(a,a),a=i.add(a,a),new m(f,u,a)}add(t){d(t);const{px:r,py:n,pz:s}=this,{px:o,py:h,pz:f}=t;let u=i.ZERO,a=i.ZERO,l=i.ZERO;const c=e.a,p=i.mul(e.b,Q);let g=i.mul(r,o),w=i.mul(n,h),b=i.mul(s,f),v=i.add(r,n),y=i.add(o,h);v=i.mul(v,y),y=i.add(g,w),v=i.sub(v,y),y=i.add(r,s);let M=i.add(o,f);return y=i.mul(y,M),M=i.add(g,b),y=i.sub(y,M),M=i.add(n,s),u=i.add(h,f),M=i.mul(M,u),u=i.add(w,b),M=i.sub(M,u),l=i.mul(c,y),u=i.mul(p,b),l=i.add(u,l),u=i.sub(w,l),l=i.add(w,l),a=i.mul(u,l),w=i.add(g,g),w=i.add(w,g),b=i.mul(c,b),y=i.mul(p,y),w=i.add(w,b),b=i.sub(g,b),b=i.mul(c,b),y=i.add(y,b),g=i.mul(w,y),a=i.add(a,g),g=i.mul(M,y),u=i.mul(v,u),u=i.sub(u,g),g=i.mul(v,w),l=i.mul(M,l),l=i.add(l,g),new m(u,a,l)}subtract(t){return this.add(t.negate())}is0(){return this.equals(m.ZERO)}wNAF(t){return g.wNAFCached(this,l,t,(t=>{const e=i.invertBatch(t.map((t=>t.pz)));return t.map(((t,i)=>t.toAffine(e[i]))).map(m.fromAffine)}))}multiplyUnsafe(t){const r=m.ZERO;if(t.isZero())return r;if(f(t),t.isOne())return this;const{endo:n}=e;if(!n)return g.unsafeLadder(this,t);let{k1neg:s,k1:o,k2neg:h,k2:u}=n.splitScalar(t),a=r,l=r,d=this;for(;o.gt(X)||u.gt(X);)o.isEven()||(a=a.add(d)),u.isEven()||(l=l.add(d)),d=d.double(),o=o.rightShift(J),u=u.rightShift(J);return s&&(a=a.negate()),h&&(l=l.negate()),l=new m(i.mul(l.px,n.beta),l.py,l.pz),a.add(l)}multiply(t){f(t);let r,n,s=t;const{endo:o}=e;if(o){const{k1neg:t,k1:e,k2neg:h,k2:f}=o.splitScalar(s);let{p:u,f:a}=this.wNAF(e),{p:l,f:d}=this.wNAF(f);u=g.constTimeNegate(t,u),l=g.constTimeNegate(h,l),l=new m(i.mul(l.px,o.beta),l.py,l.pz),r=u.add(l),n=a.add(d)}else{const{p:t,f:e}=this.wNAF(s);r=t,n=e}return m.normalizeZ([r,n])[0]}multiplyAndAddUnsafe(t,e,i){const r=m.BASE,n=(t,e)=>e.isZero()||e.isOne()||!t.equals(r)?t.multiplyUnsafe(e):t.multiply(e),s=n(this,e).add(n(t,i));return s.is0()?void 0:s}toAffine(t){const{px:e,py:r,pz:n}=this,s=this.is0();null==t&&(t=s?i.ONE:i.inv(n));const o=i.mul(e,t),h=i.mul(r,t),f=i.mul(n,t);if(s)return{x:i.ZERO,y:i.ZERO};if(!i.eql(f,i.ONE))throw Error("invZ was invalid");return{x:o,y:h}}isTorsionFree(){const{h:t,isTorsionFree:i}=e;if(t.isOne())return!0;if(i)return i(m,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:t,clearCofactor:i}=e;return t.isOne()?this:i?i(m,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return this.assertValidity(),r(m,this,t)}toHex(t=!0){return a(this.toRawBytes(t))}}m.BASE=new m(e.Gx,e.Gy,i.ONE),m.ZERO=new m(i.ZERO,i.ONE,i.ZERO);const p=e.nBitLength,g=V(m,e.endo?Math.ceil(p/2):p);return{CURVE:e,ProjectivePoint:m,normPrivateKeyToScalar:u,weierstrassEquation:o,isWithinCurveOrder:h}}({...e,toBytes(t,e,r){const n=e.toAffine(),s=i.toBytes(n.x),o=b;return r?o(Uint8Array.from([e.hasEvenY()?2:3]),s):o(Uint8Array.from([4]),s,i.toBytes(n.y))},fromBytes(t){const e=t.length,r=t[0],n=t.subarray(1);if(e!==s||2!==r&&3!==r){if(e===o&&4===r)return{x:i.fromBytes(n.subarray(0,i.BYTES)),y:i.fromBytes(n.subarray(i.BYTES,2*i.BYTES))};throw Error(`Point of length ${e} was invalid. Expected ${s} compressed bytes or ${o} uncompressed bytes`)}{const t=c(n);if(h=t,!X.lt(h)||!h.lt(i.ORDER))throw Error("Point is not on curve");const e=y(t);let s=i.sqrt(e);return 1==(1&r)!=!s.isEven()&&(s=i.neg(s)),{x:t,y:s}}var h}}),x=t=>a(p(t,e.nByteLength));function S(t){const e=r.rightShift(J);return t.gt(e)}const A=(t,e,i)=>c(t.slice(e,i));class O{constructor(t,e,i){this.r=t,this.s=e,this.recovery=i,this.assertValidity()}static fromCompact(t){const i=e.nByteLength;return t=w("compactSignature",t,2*i),new O(A(t,0,i),A(t,i,2*i))}static fromDER(t){const{r:e,s:i}=Y.toSig(w("DER",t));return new O(e,i)}assertValidity(){if(!M(this.r))throw Error("r must be 0 < r < CURVE.n");if(!M(this.s))throw Error("s must be 0 < s < CURVE.n")}addRecoveryBit(t){return new O(this.r,this.s,t)}recoverPublicKey(t){const{r,s:n,recovery:s}=this,o=q(w("msgHash",t));if(null==s||![0,1,2,3].includes(s))throw Error("recovery id invalid");const a=2===s||3===s?r.add(e.n):r;if(a.gte(i.ORDER))throw Error("recovery id 2 or 3 invalid");const l=0==(1&s)?"02":"03",d=u.fromHex(l+x(a)),c=f(a),m=h(o.negate().imul(c)),p=h(n.mul(c)),g=u.BASE.multiplyAndAddUnsafe(d,m,p);if(!g)throw Error("point at infinify");return g.assertValidity(),g}hasHighS(){return S(this.s)}normalizeS(){return this.hasHighS()?new O(this.r,h(this.s.negate()),this.recovery):this}toDERRawBytes(){return d(this.toDERHex())}toDERHex(){return Y.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return d(this.toCompactHex())}toCompactHex(){return x(this.r)+x(this.s)}}const L={isValidPrivateKey(t){try{return l(t),!0}catch(t){return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{const t=P(e.n);return function(t,e,i=!1){const r=t.length,n=C(e),s=P(e);if(r<16||r<s||r>1024)throw Error(`expected ${s}-1024 bytes of input, got ${r}`);const o=N(i?c(t):m(t),e.dec()).inc();return i?g(o,n):p(o,n)}(e.randomBytes(t),e.n)},precompute:(t=8,e=u.BASE)=>(e._setWindowSize(t),e.multiply(n.B.new(3)),e)};function _(t){const e=t instanceof Uint8Array,i="string"==typeof t,r=(e||i)&&t.length;return e?r===s||r===o:i?r===2*s||r===2*o:t instanceof u}const I=e.bits2int||function(t){const i=c(t),r=8*t.length-e.nBitLength;return r>0?i.rightShift(n.B.new(r)):i},q=e.bits2int_modN||function(t){return h(I(t))},k=v(e.nBitLength);function z(t){if(!(t instanceof n.B))throw Error("bigint expected");if(!X.lte(t)||!t.lt(k))throw Error("bigint expected < 2^"+e.nBitLength);return p(t,e.nByteLength)}function R(t,r,n=H){if(["recovered","canonical"].some((t=>t in n)))throw Error("sign() legacy options not supported");const{hash:s,randomBytes:o}=e;let{lowS:a,prehash:d,extraEntropy:c}=n;null==a&&(a=!0),t=w("msgHash",t),d&&(t=w("prehashed msgHash",s(t)));const m=q(t),p=l(r),g=[z(p),z(m)];if(null!=c){const t=!0===c?o(i.BYTES):c;g.push(w("extraEntropy",t))}const v=b(...g),y=m;return{seed:v,k2sig:function(t){const e=I(t);if(!M(e))return;const i=f(e),r=u.BASE.multiply(e).toAffine(),n=h(r.x);if(n.isZero())return;const s=h(i.mul(h(y.add(n.mul(p)))));if(s.isZero())return;let o=(r.x.equal(n)?0:2)|r.y.getBit(0),l=s;return a&&S(s)&&(l=function(t){return S(t)?h(t.negate()):t}(s),o^=1),new O(n,l,o)}}}const H={lowS:e.lowS,prehash:!1},U={lowS:e.lowS,prehash:!1};return u.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(t,e=!0){return u.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,i=!0){if(_(t))throw Error("first arg must be private key");if(!_(e))throw Error("second arg must be public key");return u.fromHex(e).multiply(l(t)).toRawBytes(i)},sign:function(t,i,r=H){const{seed:n,k2sig:s}=R(t,i,r),o=e;return B(o.hash.outputLen,o.nByteLength,o.hmac)(n,s)},verify:function(t,i,r,s=U){const o=t;if(i=w("msgHash",i),r=w("publicKey",r),"strict"in s)throw Error("options.strict was renamed to lowS");const{lowS:a,prehash:l}=s;let d,c;try{if("string"==typeof o||o instanceof Uint8Array)try{d=O.fromDER(o)}catch(t){if(!(t instanceof Y.Err))throw t;d=O.fromCompact(o)}else{if(!("object"==typeof o&&o.r instanceof n.B&&o.s instanceof n.B))throw Error("PARSE");{const{r:t,s:e}=o;d=new O(t,e)}}c=u.fromHex(r)}catch(t){if("PARSE"===t.message)throw Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(a&&d.hasHighS())return!1;l&&(i=e.hash(i));const{r:m,s:p}=d,g=q(i),b=f(p),v=h(g.mul(b)),y=h(m.mul(b)),M=u.BASE.multiplyAndAddUnsafe(c,v,y)?.toAffine();return!!M&&h(M.x).equal(m)},ProjectivePoint:u,Signature:O,utils:L}}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function et(t){return{hash:t,hmac:(e,...i)=>o(t,e,(0,r.c)(...i)),randomBytes:r.r}}function it(t,e){const i=e=>tt({...t,...et(e)});return Object.freeze({...i(e),create:i})}
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.freeze(n.B.new(4));const rt=T(n.B.new("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),nt=it({a:rt.create(n.B.new("-3")),b:n.B.new("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:rt,n:n.B.new("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:n.B.new("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:n.B.new("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:n.B.new(1),lowS:!1},r.s),st=T(n.B.new("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff")),ot=it({a:st.create(n.B.new("-3")),b:n.B.new("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Fp:st,n:n.B.new("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:n.B.new("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:n.B.new("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:n.B.new(1),lowS:!1},r.a),ht=T(n.B.new("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")),ft={a:ht.create(n.B.new("-3")),b:n.B.new("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Fp:ht,n:n.B.new("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:n.B.new("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:n.B.new("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:n.B.new(1)},ut=it({a:ft.a,b:ft.b,Fp:ht,n:ft.n,Gx:ft.Gx,Gy:ft.Gy,h:ft.h,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},r.d),at=T(n.B.new("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),lt=it({a:at.create(n.B.new("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:n.B.new("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:at,n:n.B.new("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:n.B.new("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:n.B.new("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:n.B.new(1),lowS:!1},r.s),dt=T(n.B.new("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),ct=it({a:dt.create(n.B.new("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:n.B.new("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:dt,n:n.B.new("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:n.B.new("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:n.B.new("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:n.B.new(1),lowS:!1},r.a),mt=T(n.B.new("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),pt=it({a:mt.create(n.B.new("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:n.B.new("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:mt,n:n.B.new("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:n.B.new("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:n.B.new("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:n.B.new(1),lowS:!1},r.d),gt=Object.freeze(n.B.new(0)),wt=Object.freeze(n.B.new(1)),bt=Object.freeze(n.B.new(2)),vt=Object.freeze(n.B.new(3)),yt=Object.freeze(n.B.new(8)),Mt={zip215:!0};
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Bt=Object.freeze(n.B.new(0)),xt=Object.freeze(n.B.new(1)),Et=Object.freeze(n.B.new(2));
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const St=(0,r.w)((()=>r.f.create({dkLen:114}))),At=((0,r.w)((()=>r.f.create({dkLen:64}))),n.B.new("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439")),Ot=n.B.new(1),Lt=n.B.new(2),_t=n.B.new(3),It=n.B.new(11),qt=n.B.new(22),kt=n.B.new(44),zt=n.B.new(88),Rt=n.B.new(223);function Nt(t){const e=At,i=t.modExp(_t,e),r=i.mul(i).imul(t).imod(e),n=U(r,_t,e).imul(r).imod(e),s=U(n,_t,e).imul(r).imod(e),o=U(s,Lt,e).imul(i).imod(e),h=U(o,It,e).imul(o).imod(e),f=U(h,qt,e).imul(h).imod(e),u=U(f,kt,e).imul(f).imod(e),a=U(u,zt,e).imul(u).imod(e),l=U(a,kt,e).imul(f).imod(e),d=U(l,Lt,e).imul(i).imod(e),c=U(d,Ot,e).imul(t).imod(e);return U(c,Rt,e).imul(d).imod(e)}function Ht(t){return t[0]&=252,t[55]|=128,t[56]=0,t}const Ut=T(At,456,!0),Zt=function(t){const e=function(t){const e=$(t);return E(t,{hash:"function",a:"BigInteger",d:"BigInteger",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}(t),{Fp:i,n:r,prehash:s,hash:o,randomBytes:h,nByteLength:f,h:u}=e,l=bt.leftShift(n.B.new(8*f).idec()),d=i.create,c=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:i.sqrt(t.mul(i.inv(e)))}}catch(t){return{isValid:!1,value:gt}}}),p=e.adjustScalarBytes||(t=>t),g=e.domain||((t,e,i)=>{if(e.length||i)throw Error("Contexts/pre-hash are not supported");return t}),v=t=>t instanceof n.B&&t.gt(gt),y=(t,e)=>v(t)&&v(e)&&t.lt(e),M=t=>t.isZero()||y(t,l);function B(t,e){if(y(t,e))return t;throw Error(`Expected valid scalar < ${e}, got ${typeof t} ${t}`)}function x(t){return t.isZero()?t:B(t,r)}const S=new Map;function A(t){if(!(t instanceof O))throw Error("ExtendedPoint expected")}class O{constructor(t,e,i,r){if(this.ex=t,this.ey=e,this.ez=i,this.et=r,!M(t))throw Error("x required");if(!M(e))throw Error("y required");if(!M(i))throw Error("z required");if(!M(r))throw Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(t){if(t instanceof O)throw Error("extended point not allowed");const{x:e,y:i}=t||{};if(!M(e)||!M(i))throw Error("invalid affine point");return new O(e,i,wt,d(e.mul(i)))}static normalizeZ(t){const e=i.invertBatch(t.map((t=>t.ez)));return t.map(((t,i)=>t.toAffine(e[i]))).map(O.fromAffine)}_setWindowSize(t){this._WINDOW_SIZE=t,S.delete(this)}assertValidity(){const{a:t,d:i}=e;if(this.is0())throw Error("bad point: ZERO");const{ex:r,ey:n,ez:s,et:o}=this,h=d(r.mul(r)),f=d(n.mul(n)),u=d(s.mul(s)),a=d(u.mul(u)),l=d(h.mul(t)),c=d(u.mul(d(l.add(f)))),m=d(a.add(d(i.mul(d(h.mul(f))))));if(!c.equal(m))throw Error("bad point: equation left != right (1)");const p=d(r.mul(n)),g=d(s.mul(o));if(!p.equal(g))throw Error("bad point: equation left != right (2)")}equals(t){A(t);const{ex:e,ey:i,ez:r}=this,{ex:n,ey:s,ez:o}=t,h=d(e.mul(o)),f=d(n.mul(r)),u=d(i.mul(o)),a=d(s.mul(r));return h.equal(f)&&u.equal(a)}is0(){return this.equals(O.ZERO)}negate(){return new O(d(this.ex.negate()),this.ey,this.ez,d(this.et.negate()))}double(){const{a:t}=e,{ex:i,ey:r,ez:n}=this,s=d(i.mul(i)),o=d(r.mul(r)),h=d(bt.mul(d(n.mul(n)))),f=d(t.mul(s)),u=i.add(r),a=d(d(u.mul(u)).sub(s).isub(o)),l=f.add(o),c=l.sub(h),m=f.sub(o),p=d(a.mul(c)),g=d(l.mul(m)),w=d(a.mul(m)),b=d(c.mul(l));return new O(p,g,b,w)}add(t){A(t);const{a:i,d:r}=e,{ex:s,ey:o,ez:h,et:f}=this,{ex:u,ey:a,ez:l,et:c}=t;if(i.equal(n.B.new(-1))){const t=d(o.sub(s).imul(a.add(u))),e=d(o.add(s).imul(a.sub(u))),i=d(e.sub(t));if(i.isZero())return this.double();const r=d(h.mul(bt).imul(c)),n=d(f.mul(bt).imul(l)),m=n.add(r),p=e.add(t),g=n.sub(r),w=d(m.mul(i)),b=d(p.mul(g)),v=d(m.mul(g)),y=d(i.mul(p));return new O(w,b,y,v)}const m=d(s.mul(u)),p=d(o.mul(a)),g=d(f.mul(r).imul(c)),w=d(h.mul(l)),b=d(s.add(o).imul(u.add(a)).isub(m).isub(p)),v=w.sub(g),y=w.add(g),M=d(p.sub(i.mul(m))),B=d(b.mul(v)),x=d(y.mul(M)),E=d(b.mul(M)),S=d(v.mul(y));return new O(B,x,S,E)}subtract(t){return this.add(t.negate())}wNAF(t){return I.wNAFCached(this,S,t,O.normalizeZ)}multiply(t){const{p:e,f:i}=this.wNAF(B(t,r));return O.normalizeZ([e,i])[0]}multiplyUnsafe(t){let e=x(t);return e.isZero()?_:this.equals(_)||e.isOne()?this:this.equals(L)?this.wNAF(e).p:I.unsafeLadder(this,e)}isSmallOrder(){return this.multiplyUnsafe(u).is0()}isTorsionFree(){return I.unsafeLadder(this,r).is0()}toAffine(t){const{ex:e,ey:r,ez:n}=this,s=this.is0();null==t&&(t=s?yt:i.inv(n));const o=d(e.mul(t)),h=d(r.mul(t)),f=d(n.mul(t));if(s)return{x:gt.clone(),y:wt.clone()};if(!f.isOne())throw Error("invZ was invalid");return{x:o,y:h}}clearCofactor(){const{h:t}=e;return t.isOne()?this:this.multiplyUnsafe(t)}static fromHex(t,r=!1){const{d:n,a:s}=e,o=i.BYTES,h=(t=w("pointHex",t,o)).slice(),f=t[o-1];h[o-1]=-129&f;const u=m(h);u.isZero()||B(u,r?l:i.ORDER);const a=d(u.mul(u)),p=d(a.dec()),g=d(n.mul(a).isub(s));let{isValid:b,value:v}=c(p,g);if(!b)throw Error("Point.fromHex: invalid y coordinate");const y=!v.isEven(),M=0!=(128&f);if(!r&&v.isZero()&&M)throw Error("Point.fromHex: x=0 and x_0=1");return M!==y&&(v=d(v.negate())),O.fromAffine({x:v,y:u})}static fromPrivateKey(t){return z(t).point}toRawBytes(){const{x:t,y:e}=this.toAffine(),r=e.toUint8Array("le",i.BYTES);return r[r.length-1]|=t.isEven()?0:128,r}toHex(){return a(this.toRawBytes())}}O.BASE=new O(e.Gx,e.Gy,wt,d(e.Gx.mul(e.Gy))),O.ZERO=new O(gt,wt,wt,gt);const{BASE:L,ZERO:_}=O,I=V(O,8*f);function q(t){return N(t,r)}function k(t){return q(m(t))}function z(t){const e=f;t=w("private key",t,e);const i=w("hashed private key",o(t),2*e),r=p(i.slice(0,e)),n=i.slice(e,2*e),s=k(r),h=L.multiply(s),u=h.toRawBytes();return{head:r,prefix:n,scalar:s,point:h,pointBytes:u}}function R(t=new Uint8Array,...e){const i=b(...e);return k(o(g(i,w("context",t),!!s)))}const H=Mt;return L._setWindowSize(8),{CURVE:e,getPublicKey:function(t){return z(t).pointBytes},sign:function(t,e,r={}){t=w("message",t),s&&(t=s(t));const{prefix:n,scalar:o,pointBytes:h}=z(e),u=R(r.context,n,t),a=L.multiply(u).toRawBytes(),l=R(r.context,a,h,t),d=q(u.add(l.mul(o)));return x(d),w("result",b(a,d.toUint8Array("le",i.BYTES)),2*f)},verify:function(t,e,r,n=H){const{context:o,zip215:h}=n,f=i.BYTES;t=w("signature",t,2*f),e=w("message",e),s&&(e=s(e));const u=m(t.slice(f,2*f));let a,l,d;try{a=O.fromHex(r,h),l=O.fromHex(t.slice(0,f),h),d=L.multiplyUnsafe(u)}catch(t){return!1}if(!h&&a.isSmallOrder())return!1;const c=R(o,l.toRawBytes(),a.toRawBytes(),e);return l.add(a.multiplyUnsafe(c)).subtract(d).clearCofactor().equals(O.ZERO)},ExtendedPoint:O,utils:{getExtendedPublicKey:z,randomPrivateKey:()=>h(i.BYTES),precompute:(t=8,e=O.BASE)=>(e._setWindowSize(t),e.multiply(vt),e)}}}({a:n.B.new(1),d:n.B.new("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358"),Fp:Ut,n:n.B.new("181709681073901722637330951972001133588410340171829515070372549795146003961539585716195755291692375963310293709091662304773755859649779"),nBitLength:456,h:n.B.new(4),Gx:n.B.new("224580040295924300187604334099896036246789641632564134246125461686950415467406032909029192869357953282578032075146446173674602635247710"),Gy:n.B.new("298819210078481492676017930443930673437544040154080242095928241372331506189835876003536878655418784733982303233503462500531545062832660"),hash:St,randomBytes:r.r,adjustScalarBytes:Ht,domain:(t,e,i)=>{if(e.length>255)throw Error("Context is too big: "+e.length);return(0,r.c)((0,r.u)("SigEd448"),new Uint8Array([i?1:0,e.length]),e,t)},uvRatio:function(t,e){const i=At,r=N(t.mul(t).imul(e),i),n=N(r.mul(t),i),s=Nt(N(n.mul(r).imul(e),i)),o=N(n.mul(s),i),h=N(o.mul(o),i);return{isValid:N(h.mul(e),i).equal(t),value:o}}}),jt=function(t){const e=(E(i=t,{a:"BigInteger"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"BigInteger"}),Object.freeze({...i}));var i;const{P:r}=e,s=t=>N(t,r),o=e.montgomeryBits,h=Math.ceil(o/8),f=e.nByteLength,u=e.adjustScalarBytes||(t=>t),a=e.powPminus2||(t=>H(t,r.sub(Et),r));function l(t,e,i){const r=s(t.mul(e.sub(i)));return[e=s(e.sub(r)),i=s(i.add(r))]}function d(t){if(t instanceof n.B&&!t.isNegative()&&t.lt(r))return t;throw Error("Expected valid scalar 0 < scalar < CURVE.P")}const c=e.a.sub(Et).irightShift(Et);function p(t){return g(s(t),h)}function b(t,e){const i=function(t){const e=w("u coordinate",t,h);return 32===f&&(e[31]&=127),m(e)}(e),r=function(t){const e=w("scalar",t),i=e.length;if(i!==h&&i!==f)throw Error(`Expected ${h} or ${f} bytes, got ${i}`);return m(u(e))}(t),g=function(t,e){const i=d(t),r=d(e),h=i;let f,u=xt,m=Bt,p=i,g=xt,w=Bt.clone();for(let t=n.B.new(o-1);!t.isNegative();t.idec()){const e=n.B.new(r.rightShift(t).getBit(0));w.ixor(e),f=l(w,u,p),u=f[0],p=f[1],f=l(w,m,g),m=f[0],g=f[1],w=e;const i=u.add(m),o=s(i.mul(i)),a=u.sub(m),d=s(a.mul(a)),b=o.sub(d),v=p.add(g),y=p.sub(g),M=s(y.mul(i)),B=s(v.mul(a)),x=M.add(B),E=M.sub(B);p=s(x.mul(x)),g=s(h.mul(s(E.mul(E)))),u=s(o.mul(d)),m=s(b.mul(o.add(s(c.mul(b)))))}f=l(w,u,p),u=f[0],p=f[1],f=l(w,m,g),m=f[0],g=f[1];const b=a(m);return s(u.mul(b))}(i,r);if(g.isZero())throw Error("Invalid private or public key received");return p(g)}const v=p(e.Gu);function y(t){return b(t,v)}return{scalarMult:b,scalarMultBase:y,getSharedSecret:(t,e)=>b(t,e),getPublicKey:t=>y(t),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:v}}({a:n.B.new(156326),montgomeryBits:448,nByteLength:56,P:At,Gu:n.B.new(5),powPminus2:t=>{const e=At;return N(U(Nt(t),n.B.new(2),e).mul(t),e)},adjustScalarBytes:Ht,randomBytes:r.r});Object.freeze(n.B.new(4)),Ut.ORDER.sub(_t).irightShift(Lt),n.B.new(156326),n.B.new("39082"),n.B.new("78163"),n.B.new("98944233647732219769177004876929019128417576295529901074099889598043702116001257856802131563896515373927712232092845883226922417596214"),n.B.new("315019913931389607337177038330951043522456072897266928557328499619017160722351061360252776265186336876723201881398623946864393857820716"),n.B.new("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");
/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */
const Ft=Object.freeze(n.B.new("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f")),Tt=Object.freeze(n.B.new("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"));Object.freeze(n.B.new(0));const Ct=Object.freeze(n.B.new(1)),Pt=Object.freeze(n.B.new(2)),Gt=(t,e)=>t.add(e.rightShift(Ct)).idiv(e),Dt=T(Ft,void 0,void 0,{sqrt:function(t){const e=Ft,i=n.B.new(3),r=n.B.new(6),s=n.B.new(11),o=n.B.new(22),h=n.B.new(23),f=n.B.new(44),u=n.B.new(88),a=t.mul(t).imul(t).imod(e),l=a.mul(a).imul(t).imod(e),d=U(l,i,e).imul(l).imod(e),c=U(d,i,e).imul(l).imod(e),m=U(c,Pt,e).imul(a).imod(e),p=U(m,s,e).imul(m).imod(e),g=U(p,o,e).imul(p).imod(e),w=U(g,f,e).imul(g).imod(e),b=U(w,u,e).imul(w).imod(e),v=U(b,f,e).imul(g).imod(e),y=U(v,i,e).imul(l).imod(e),M=U(y,h,e).imul(p).imod(e),B=U(M,r,e).imul(a).imod(e),x=U(B,Pt,e);if(!Dt.eql(Dt.sqr(x),t))throw Error("Cannot find square root");return x}}),Vt=it({a:n.B.new(0),b:n.B.new(7),Fp:Dt,n:Tt,Gx:n.B.new("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:n.B.new("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:n.B.new(1),lowS:!0,endo:{beta:n.B.new("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=Tt,i=n.B.new("0x3086d221a7d46bcde86c90e49284eb15"),r=Ct.negate().imul(n.B.new("0xe4437ed6010e88286f547fa90abfe4c3")),s=n.B.new("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=i,h=n.B.new("0x100000000000000000000000000000000"),f=Gt(o.mul(t),e),u=Gt(r.negate().imul(t),e);let a=N(t.sub(f.mul(i)).sub(u.mul(s)),e),l=N(f.negate().mul(r).isub(u.mul(o)),e);const d=a.gt(h),c=l.gt(h);if(d&&(a=e.sub(a)),c&&(l=e.sub(l)),a.gt(h)||l.gt(h))throw Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:d,k1:a,k2neg:c,k2:l}}}},r.s);Vt.ProjectivePoint;const $t=new Map(Object.entries({p256:nt,p384:ot,p521:ut,brainpoolP256r1:lt,brainpoolP384r1:ct,brainpoolP512r1:pt,secp256k1:Vt,x448:jt,ed448:Zt}))},21012:(t,e,i)=>{i.d(e,{H:()=>v,S:()=>B,a:()=>$,b:()=>f,c:()=>b,d:()=>V,e:()=>a,f:()=>lt,g:()=>I,h:()=>u,i:()=>ut,j:()=>at,r:()=>M,s:()=>_,t:()=>w,u:()=>g,w:()=>y});var r=i(77680),n=i(32772),s=i(31016);
/*! OpenPGP.js v6.0.0-alpha.0 - 2023-12-12 - this is LGPL licensed code, see LICENSE/our website https://openpgpjs.org/ for more information. */
const o="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function h(t){if(!Number.isSafeInteger(t)||t<0)throw Error("Wrong positive integer: "+t)}function f(t,...e){if(!(t instanceof Uint8Array))throw Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function u(t){if("function"!=typeof t||"function"!=typeof t.create)throw Error("Hash should be wrapped by utils.wrapConstructor");h(t.outputLen),h(t.blockLen)}function a(t,e=!0){if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")}function l(t,e){f(t);const i=e.outputLen;if(t.length<i)throw Error("digestInto() expects output buffer of length at least "+i)}const d="object"==typeof o&&"crypto"in o?o.crypto:void 0,c=t=>t instanceof Uint8Array,m=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),p=(t,e)=>t<<32-e|t>>>e
/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */;if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw Error("Non little-endian hardware is not supported");function g(t){if("string"!=typeof t)throw Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}function w(t){if("string"==typeof t&&(t=g(t)),!c(t))throw Error("expected Uint8Array, got "+typeof t);return t}function b(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.length),0));let i=0;return t.forEach((t=>{if(!c(t))throw Error("Uint8Array expected");e.set(t,i),i+=t.length})),e}class v{clone(){return this._cloneInto()}}function y(t){const e=e=>t().update(w(e)).digest(),i=t();return e.outputLen=i.outputLen,e.blockLen=i.blockLen,e.create=()=>t(),e}function M(t=32){if(d&&"function"==typeof d.getRandomValues)return d.getRandomValues(new Uint8Array(t));throw Error("crypto.getRandomValues must be defined")}r.B.setImplementation("undefined"!=typeof BigInt?n.default:s.default);class B extends v{constructor(t,e,i,r){super(),this.blockLen=t,this.outputLen=e,this.padOffset=i,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=m(this.buffer)}update(t){a(this);const{view:e,buffer:i,blockLen:r}=this,n=(t=w(t)).length;for(let s=0;s<n;){const o=Math.min(r-this.pos,n-s);if(o!==r)i.set(t.subarray(s,s+o),this.pos),this.pos+=o,s+=o,this.pos===r&&(this.process(e,0),this.pos=0);else{const e=m(t);for(;r<=n-s;s+=r)this.process(e,s)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){a(this),l(t,this),this.finished=!0;const{buffer:e,view:i,blockLen:n,isLE:s}=this;let{pos:o}=this;e[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(i,0),o=0);for(let t=o;t<n;t++)e[t]=0;!function(t,e,i,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,BigInt(i.toString()),n);const s=Object.freeze(r.B.new(32)),o=Object.freeze(r.B.new(4294967295)),h=i.rightShift(s).bitwiseAnd(o).toNumber(),f=i.bitwiseAnd(o).toNumber(),u=n?4:0,a=n?0:4;t.setUint32(e+u,h,n),t.setUint32(e+a,f,n)}(i,n-8,r.B.new(8*this.length),s),this.process(i,0);const h=m(t),f=this.outputLen;if(f%4)throw Error("_sha2: outputLen should be aligned to 32bit");const u=f/4,d=this.get();if(u>d.length)throw Error("_sha2: outputLen bigger than state");for(let t=0;t<u;t++)h.setUint32(4*t,d[t],s)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const i=t.slice(0,e);return this.destroy(),i}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:i,length:r,finished:n,destroyed:s,pos:o}=this;return t.length=r,t.pos=o,t.finished=n,t.destroyed=s,r%e&&t.buffer.set(i),t}}const x=(t,e,i)=>t&e^t&i^e&i,E=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),S=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),A=new Uint32Array(64);class O extends B{constructor(){super(64,32,8,!1),this.A=0|S[0],this.B=0|S[1],this.C=0|S[2],this.D=0|S[3],this.E=0|S[4],this.F=0|S[5],this.G=0|S[6],this.H=0|S[7]}get(){const{A:t,B:e,C:i,D:r,E:n,F:s,G:o,H:h}=this;return[t,e,i,r,n,s,o,h]}set(t,e,i,r,n,s,o,h){this.A=0|t,this.B=0|e,this.C=0|i,this.D=0|r,this.E=0|n,this.F=0|s,this.G=0|o,this.H=0|h}process(t,e){for(let i=0;i<16;i++,e+=4)A[i]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=A[t-15],i=A[t-2],r=p(e,7)^p(e,18)^e>>>3,n=p(i,17)^p(i,19)^i>>>10;A[t]=n+A[t-7]+r+A[t-16]|0}let{A:i,B:r,C:n,D:s,E:o,F:h,G:f,H:u}=this;for(let t=0;t<64;t++){const e=u+(p(o,6)^p(o,11)^p(o,25))+((a=o)&h^~a&f)+E[t]+A[t]|0,l=(p(i,2)^p(i,13)^p(i,22))+x(i,r,n)|0;u=f,f=h,h=o,o=s+e|0,s=n,n=r,r=i,i=e+l|0}var a;i=i+this.A|0,r=r+this.B|0,n=n+this.C|0,s=s+this.D|0,o=o+this.E|0,h=h+this.F|0,f=f+this.G|0,u=u+this.H|0,this.set(i,r,n,s,o,h,f,u)}roundClean(){A.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class L extends O{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const _=y((()=>new O)),I=y((()=>new L)),q=Object.freeze(r.B.new(2**32-1)),k=Object.freeze(r.B.new(32));function z(t,e=!1){return e?{h:t.bitwiseAnd(q).toNumber(),l:t.rightShift(k).bitwiseAnd(q).toNumber()}:{h:0|t.rightShift(k).bitwiseAnd(q).toNumber(),l:0|t.bitwiseAnd(q).toNumber()}}function R(t,e=!1){let i=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let n=0;n<t.length;n++){const{h:s,l:o}=z(t[n],e);[i[n],r[n]]=[s,o]}return[i,r]}const N=(t,e,i)=>t<<i|e>>>32-i,H=(t,e,i)=>e<<i|t>>>32-i,U=(t,e,i)=>e<<i-32|t>>>64-i,Z=(t,e,i)=>t<<i-32|e>>>64-i;var j={fromBig:z,split:R,toBig:(t,e)=>r.B.new(t>>>0).ileftShift(k).ibitwiseOr(r.B.new(e>>>0)),shrSH:(t,e,i)=>t>>>i,shrSL:(t,e,i)=>t<<32-i|e>>>i,rotrSH:(t,e,i)=>t>>>i|e<<32-i,rotrSL:(t,e,i)=>t<<32-i|e>>>i,rotrBH:(t,e,i)=>t<<64-i|e>>>i-32,rotrBL:(t,e,i)=>t>>>i-32|e<<64-i,rotr32H:(t,e)=>e,rotr32L:(t,e)=>t,rotlSH:N,rotlSL:H,rotlBH:U,rotlBL:Z,add:function(t,e,i,r){const n=(e>>>0)+(r>>>0);return{h:t+i+(n/2**32|0)|0,l:0|n}},add3L:(t,e,i)=>(t>>>0)+(e>>>0)+(i>>>0),add3H:(t,e,i,r)=>e+i+r+(t/2**32|0)|0,add4L:(t,e,i,r)=>(t>>>0)+(e>>>0)+(i>>>0)+(r>>>0),add4H:(t,e,i,r,n)=>e+i+r+n+(t/2**32|0)|0,add5H:(t,e,i,r,n,s)=>e+i+r+n+s+(t/2**32|0)|0,add5L:(t,e,i,r,n)=>(t>>>0)+(e>>>0)+(i>>>0)+(r>>>0)+(n>>>0)};const[F,T]=j.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((t=>r.B.new(t)))),C=new Uint32Array(80),P=new Uint32Array(80);class G extends B{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:e,Bh:i,Bl:r,Ch:n,Cl:s,Dh:o,Dl:h,Eh:f,El:u,Fh:a,Fl:l,Gh:d,Gl:c,Hh:m,Hl:p}=this;return[t,e,i,r,n,s,o,h,f,u,a,l,d,c,m,p]}set(t,e,i,r,n,s,o,h,f,u,a,l,d,c,m,p){this.Ah=0|t,this.Al=0|e,this.Bh=0|i,this.Bl=0|r,this.Ch=0|n,this.Cl=0|s,this.Dh=0|o,this.Dl=0|h,this.Eh=0|f,this.El=0|u,this.Fh=0|a,this.Fl=0|l,this.Gh=0|d,this.Gl=0|c,this.Hh=0|m,this.Hl=0|p}process(t,e){for(let i=0;i<16;i++,e+=4)C[i]=t.getUint32(e),P[i]=t.getUint32(e+=4);for(let t=16;t<80;t++){const e=0|C[t-15],i=0|P[t-15],r=j.rotrSH(e,i,1)^j.rotrSH(e,i,8)^j.shrSH(e,i,7),n=j.rotrSL(e,i,1)^j.rotrSL(e,i,8)^j.shrSL(e,i,7),s=0|C[t-2],o=0|P[t-2],h=j.rotrSH(s,o,19)^j.rotrBH(s,o,61)^j.shrSH(s,o,6),f=j.rotrSL(s,o,19)^j.rotrBL(s,o,61)^j.shrSL(s,o,6),u=j.add4L(n,f,P[t-7],P[t-16]),a=j.add4H(u,r,h,C[t-7],C[t-16]);C[t]=0|a,P[t]=0|u}let{Ah:i,Al:r,Bh:n,Bl:s,Ch:o,Cl:h,Dh:f,Dl:u,Eh:a,El:l,Fh:d,Fl:c,Gh:m,Gl:p,Hh:g,Hl:w}=this;for(let t=0;t<80;t++){const e=j.rotrSH(a,l,14)^j.rotrSH(a,l,18)^j.rotrBH(a,l,41),b=j.rotrSL(a,l,14)^j.rotrSL(a,l,18)^j.rotrBL(a,l,41),v=a&d^~a&m,y=l&c^~l&p,M=j.add5L(w,b,y,T[t],P[t]),B=j.add5H(M,g,e,v,F[t],C[t]),x=0|M,E=j.rotrSH(i,r,28)^j.rotrBH(i,r,34)^j.rotrBH(i,r,39),S=j.rotrSL(i,r,28)^j.rotrBL(i,r,34)^j.rotrBL(i,r,39),A=i&n^i&o^n&o,O=r&s^r&h^s&h;g=0|m,w=0|p,m=0|d,p=0|c,d=0|a,c=0|l,({h:a,l}=j.add(0|f,0|u,0|B,0|x)),f=0|o,u=0|h,o=0|n,h=0|s,n=0|i,s=0|r;const L=j.add3L(x,S,O);i=j.add3H(L,B,E,A),r=0|L}({h:i,l:r}=j.add(0|this.Ah,0|this.Al,0|i,0|r)),({h:n,l:s}=j.add(0|this.Bh,0|this.Bl,0|n,0|s)),({h:o,l:h}=j.add(0|this.Ch,0|this.Cl,0|o,0|h)),({h:f,l:u}=j.add(0|this.Dh,0|this.Dl,0|f,0|u)),({h:a,l}=j.add(0|this.Eh,0|this.El,0|a,0|l)),({h:d,l:c}=j.add(0|this.Fh,0|this.Fl,0|d,0|c)),({h:m,l:p}=j.add(0|this.Gh,0|this.Gl,0|m,0|p)),({h:g,l:w}=j.add(0|this.Hh,0|this.Hl,0|g,0|w)),this.set(i,r,n,s,o,h,f,u,a,l,d,c,m,p,g,w)}roundClean(){C.fill(0),P.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class D extends G{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const V=y((()=>new G)),$=y((()=>new D)),[K,W,Y]=[[],[],[]],X=Object.freeze(r.B.new(0)),J=Object.freeze(r.B.new(1)),Q=Object.freeze(r.B.new(2)),tt=Object.freeze(r.B.new(7)),et=Object.freeze(r.B.new(256)),it=Object.freeze(r.B.new(113));for(let t=0,e=J,i=1,n=0;t<24;t++){[i,n]=[n,(2*i+3*n)%5],K.push(2*(5*n+i)),W.push((t+1)*(t+2)/2%64);const s=X.clone();for(let t=0;t<7;t++)e=e.leftShift(J).ixor(e.rightShift(tt).imul(it)).imod(et),e.bitwiseAnd(Q).isZero()||s.ixor(J.leftShift(J.leftShift(r.B.new(t)).idec()));Y.push(s)}const[rt,nt]=R(Y,!0),st=(t,e,i)=>i>32?U(t,e,i):N(t,e,i),ot=(t,e,i)=>i>32?Z(t,e,i):H(t,e,i);class ht extends v{constructor(t,e,i,r=!1,n=24){if(super(),this.blockLen=t,this.suffix=e,this.outputLen=i,this.enableXOF=r,this.rounds=n,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,h(i),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");var s;this.state=new Uint8Array(200),this.state32=(s=this.state,new Uint32Array(s.buffer,s.byteOffset,Math.floor(s.byteLength/4)))}keccak(){!function(t,e=24){const i=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let e=0;e<10;e++)i[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){const r=(e+8)%10,n=(e+2)%10,s=i[n],o=i[n+1],h=st(s,o,1)^i[r],f=ot(s,o,1)^i[r+1];for(let i=0;i<50;i+=10)t[e+i]^=h,t[e+i+1]^=f}let e=t[2],n=t[3];for(let i=0;i<24;i++){const r=W[i],s=st(e,n,r),o=ot(e,n,r),h=K[i];e=t[h],n=t[h+1],t[h]=s,t[h+1]=o}for(let e=0;e<50;e+=10){for(let r=0;r<10;r++)i[r]=t[e+r];for(let r=0;r<10;r++)t[e+r]^=~i[(r+2)%10]&i[(r+4)%10]}t[0]^=rt[r],t[1]^=nt[r]}i.fill(0)}(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){a(this);const{blockLen:e,state:i}=this,r=(t=w(t)).length;for(let n=0;n<r;){const s=Math.min(e-this.pos,r-n);for(let e=0;e<s;e++)i[this.pos++]^=t[n++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:e,pos:i,blockLen:r}=this;t[i]^=e,0!=(128&e)&&i===r-1&&this.keccak(),t[r-1]^=128,this.keccak()}writeInto(t){a(this,!1),f(t),this.finish();const e=this.state,{blockLen:i}=this;for(let r=0,n=t.length;r<n;){this.posOut>=i&&this.keccak();const s=Math.min(i-this.posOut,n-r);t.set(e.subarray(this.posOut,this.posOut+s),r),this.posOut+=s,r+=s}return t}xofInto(t){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return h(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(l(t,this),this.finished)throw Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:e,suffix:i,outputLen:r,rounds:n,enableXOF:s}=this;return t||(t=new ht(e,i,r,s,n)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=n,t.suffix=i,t.outputLen=r,t.enableXOF=s,t.destroyed=this.destroyed,t}}const ft=(t,e,i)=>y((()=>new ht(e,t,i))),ut=ft(6,136,32),at=ft(6,72,64),lt=function(t){const e=(e,i)=>t(i).update(w(e)).digest(),i=t({});return e.outputLen=i.outputLen,e.blockLen=i.blockLen,e.create=e=>t(e),e}(((t={})=>new ht(136,31,void 0===t.dkLen?32:t.dkLen,!0)))}}]);
//# sourceMappingURL=chunk.4584.js.map